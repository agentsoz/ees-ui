(function(e){function t(t){for(var i,n,s=t[0],l=t[1],c=t[2],u=0,p=[];u<s.length;u++)n=s[u],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&p.push(o[n][0]),o[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);d&&d(t);while(p.length)p.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],i=!0,n=1;n<a.length;n++){var s=a[n];0!==o[s]&&(i=!1)}i&&(r.splice(t--,1),e=l(l.s=a[0]))}return e}var i={},n={app:0},o={app:0},r=[];function s(e){return l.p+"js/"+({about:"about"}[e]||e)+"."+{about:"4b014ceb"}[e]+".js"}function l(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.e=function(e){var t=[],a={about:1};n[e]?t.push(n[e]):0!==n[e]&&a[e]&&t.push(n[e]=new Promise((function(t,a){for(var i="css/"+({about:"about"}[e]||e)+"."+{about:"e8a3e408"}[e]+".css",o=l.p+i,r=document.getElementsByTagName("link"),s=0;s<r.length;s++){var c=r[s],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===i||u===o))return t()}var p=document.getElementsByTagName("style");for(s=0;s<p.length;s++){c=p[s],u=c.getAttribute("data-href");if(u===i||u===o)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var i=t&&t.target&&t.target.src||o,r=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=i,delete n[e],d.parentNode.removeChild(d),a(r)},d.href=o;var m=document.getElementsByTagName("head")[0];m.appendChild(d)})).then((function(){n[e]=0})));var i=o[e];if(0!==i)if(i)t.push(i[2]);else{var r=new Promise((function(t,a){i=o[e]=[t,a]}));t.push(i[2]=r);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=s(e);var p=new Error;c=function(t){u.onerror=u.onload=null,clearTimeout(d);var a=o[e];if(0!==a){if(a){var i=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+i+": "+n+")",p.name="ChunkLoadError",p.type=i,p.request=n,a[1](p)}o[e]=void 0}};var d=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(t)},l.m=e,l.c=i,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)l.d(a,i,function(t){return e[t]}.bind(null,i));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/ees-ui/",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var p=0;p<c.length;p++)t(c[p]);var d=u;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0dc4":function(e,t,a){},"0ebb":function(e,t,a){},"11d8":function(e,t,a){"use strict";var i=a("50f0"),n=a.n(i);n.a},1570:function(e,t,a){"use strict";var i=a("826e"),n=a.n(i);n.a},"24f5":function(e,t,a){"use strict";var i=a("9c29"),n=a.n(i);n.a},3126:function(e,t,a){"use strict";var i=a("0ebb"),n=a.n(i);n.a},3153:function(e,t,a){"use strict";var i=a("8b15"),n=a.n(i);n.a},4658:function(e,t,a){},"50f0":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("14c6"),a("08c1"),a("4842"),a("d9fc");var i,n,o,r,s,l,c=a("2b0e"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view",{staticClass:"router-view"})],1)},p=[],d=(a("5c0b"),a("2877")),m={},f=Object(d["a"])(m,u,p,!1,null,null,null),h=f.exports,v=a("8c4f"),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{on:{"!keydown":function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.toggleSettingsVis()}}},[a("maplayer"),a("popLegend"),a("slider"),a("spinner"),a("population"),a("setup"),a("buttons"),a("savesettings")],1)},b=[],g=a("cebc"),S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("mapbox",{attrs:{"access-token":e.mapboxAccessToken,"map-options":e.mapOpts,"geolocate-control":{show:!0,position:"top-right"},"scale-control":{show:!0,position:"bottom-left"}},on:{"map-load":e.storeMapInstance}})},O=[],_=(a("6762"),a("2fdb"),a("ac6a"),a("873e")),T=a("e192"),k=a.n(T),L=a("6ee6"),I=a.n(L),w=a("b106"),x=a.n(w),A=a("2f62"),M=a("bd86"),C="START_LOADING",E="DONE_LOADING",j="SET_MAP_INSTANCE",N="SET_DRAW_INSTANCE",P="SET_MAPBOX_STYLE",R="SETTINGS_VISIBILITY",D="SELECT_REGION",F="CLEAR_REGION",$="FLY_TO",G="SET_FIRST_SYMBOL_LAYER",H="MATSIM_ADD_SOURCE",U="MATSIM_ADD_LAYER",B="MATSIM_SET_BASE_LAYER",q="MATSIM_SET_HIGHLIGHT_LAYER",W="MATSIM_SET_SELECTED_DISRUPTION_LAYER",V="MATSIM_SET_DISRUPTION_LAYER",Y="MATSIMATSIM_ADD_DISRUPTION",J="MATSIM_SELECT_LINK",z="MATSIM_DESELECT_LINK",X="MATSIM_SAVE_CONFIG",K="MATSIM_SETTINGS_VIS",Z="SELECT_FIRE",Q="CLEAR_FIRE",ee="SELECT_POPULATION",te="CLEAR_POPULATION",ae="POPULATION_SET_OPACITY",ie="POP_ADD_SOURCE",ne="POP_ADD_LAYER",oe="PHOENIX_ADD_SOURCE",re="PHOENIX_ADD_LAYER",se="PHOENIX_SET_OPACITY",le="PHOENIX_TIME_STEP",ce="DRAW_SMOKE",ue="EMBER_ADD_SOURCE",pe="EMBER_ADD_LAYER",de="EMBER_SET_OPACITY",me="CLEAR_SMOKE",fe="TOGGLE_3D",he={mapboxAccessToken:"pk.eyJ1IjoiZGhpeHNpbmdoIiwiYSI6ImNqbWx4OTR0ZzBkMWUzb255and1aTUweGkifQ.U0vPiwyfM4ad7axC_4dkHg",error:null,data:null,styles:[{id:"basic",name:"Basic"},{id:"bright",name:"Bright"},{id:"dark",name:"Dark"},{id:"light",name:"Light"},{id:"satellite",name:"Satellite"},{id:"streets",name:"Streets"}]},ve={mapboxAccessToken:function(e){return e.mapboxAccessToken},styles:function(e){return e.styles},regions:function(e){return e.data?e.data.tiles:{}},populations:function(e){return e.data?e.data.populations:{}},fires:function(e){return e.data?e.data.fires:{}},region:function(e){return function(t){return e.data.tiles[t]}},populationsWithTag:function(e,t){return function(e){var a=t.populations,i={};for(var n in a)Array.isArray(a[n].tags)&&a[n].tags.includes(e)&&(i[n]=a[n]);return i}},firesWithTag:function(e,t){return function(e){var a=t.fires,i={};for(var n in a)Array.isArray(a[n].tags)&&a[n].tags.includes(e)&&(i[n]=a[n]);return i}}},ye=(i={},Object(M["a"])(i,"SAVE_SETTINGS",(function(e,t){e.data=t})),Object(M["a"])(i,"ERROR",(function(e,t){e.error=t})),i),be={getConfig:function(e,t){var a=e.commit;a(C),fetch(t).then((function(e){return e.json()})).then((function(e){a(E),a("SAVE_SETTINGS",e)})).catch((function(e){a("ERROR","Could not retreive anything from the server. Please try again later.<br />Tried URL: "+t+"<br /><br /> Error message below.<br /><br />"+e),a(E)}))}},ge={state:he,getters:ve,mutations:ye,actions:be},Se=(a("ac4d"),a("8a81"),a("7f7fd"),a("7514"),{isLoading:0,mapboxStyle:"dark",firstSymbolLayer:null,mapSettingsIsOpen:!0,baseMATSimLayer:null,highlightMATSimLayer:null,loadedMATSimLayers:[],loadedMATSimSource:null,selectedRegion:null,populationSquares:[],squarePopulationIsOpen:!1,selectedMATSimLink:"",disruptions:[],affectedLinkIsOpen:!1,mapInstance:null,drawInstance:null,mapCenter:[144.968447,-37.818232]}),Oe={mapInstance:function(e){return e.mapInstance},drawInstance:function(e){return e.drawInstance},selectedStyle:function(e,t,a){if(!e.mapboxStyle)return null;var i=a.config.styles,n=i.find((function(t){return t.id===e.mapboxStyle}));return n},selectedRegion:function(e,t,a,i){return e.selectedRegion?i.region(e.selectedRegion):null},popInSelectedRegion:function(e,t,a,i){return e.selectedRegion?i.populationsWithTag(t.selectedRegion.name):[]},firesInSelectedRegion:function(e,t,a,i){return e.selectedRegion?i.firesWithTag(t.selectedRegion.name):t.fires}},_e=(n={},Object(M["a"])(n,C,(function(e){e.isLoading++})),Object(M["a"])(n,E,(function(e){e.isLoading>0&&e.isLoading--})),Object(M["a"])(n,j,(function(e,t){e.mapInstance=t})),Object(M["a"])(n,N,(function(e,t){e.drawInstance=t})),Object(M["a"])(n,P,(function(e,t){e.mapboxStyle=t,e.mapInstance.setStyle("mapbox://styles/mapbox/"+e.mapboxStyle+"-v9")})),Object(M["a"])(n,R,(function(e,t){e.mapSettingsIsOpen=t})),Object(M["a"])(n,D,(function(e,t){e.selectedRegion=t})),Object(M["a"])(n,B,(function(e,t){e.baseMATSimLayer=t})),Object(M["a"])(n,q,(function(e,t){e.highlightMATSimLayer=t})),Object(M["a"])(n,V,(function(e,t){e.disruptionMATSimLayer=t})),Object(M["a"])(n,W,(function(e,t){e.selectedDisruptionMATSimLayer=t})),Object(M["a"])(n,Y,(function(e,t){e.disruptions.push(t)})),Object(M["a"])(n,$,(function(e,t){e.mapInstance.flyTo({center:t,zoom:8,bearing:0,speed:.5,curve:1,easing:function(e){return e}}),e.mapCenter=t})),Object(M["a"])(n,fe,(function(e,t){t?e.mapInstance.easeTo({pitch:60}):e.mapInstance.easeTo({pitch:0})})),Object(M["a"])(n,G,(function(e){for(var t,a=e.mapInstance.getStyle().layers,i=0;i<a.length;i++)if("symbol"===a[i].type&&a[i].id.includes("label")){t=a[i].id;break}e.firstSymbolLayer=t})),Object(M["a"])(n,U,(function(e,t){e.mapInstance.addLayer({id:t.layerName,type:"line",source:t.sourceName,"source-layer":t.sourceLayer,minzoom:0,maxzoom:22,paint:t.paint,filter:t.filter},e.firstSymbolLayer),e.loadedMATSimLayers.push(t.layerName)})),Object(M["a"])(n,H,(function(e,t){e.mapInstance.addSource(t.sourceName,{type:"vector",tiles:[t.pbfurl],minzoom:0,maxzoom:14}),e.loadedMATSimSource=t.sourceName})),Object(M["a"])(n,F,(function(e){var t=e.mapInstance,a=!0,i=!1,n=void 0;try{for(var o,r=e.loadedMATSimLayers[Symbol.iterator]();!(a=(o=r.next()).done);a=!0){var s=o.value;t.removeLayer(s)}}catch(l){i=!0,n=l}finally{try{a||null==r.return||r.return()}finally{if(i)throw n}}e.loadedMATSimLayers=[],e.loadedMATSimSource&&(t.removeSource(e.loadedMATSimSource),e.loadedMATSimSource=null),e.baseMATSimLayer=null,e.highlightMATSimLayer=null})),Object(M["a"])(n,"drawPopulationSquare",(function(e){var t=e.mapInstance,a=e.drawInstance;a.changeMode("draw_rectangle"),t.getCanvas().style.cursor="crosshair"})),Object(M["a"])(n,"addPopulationSquare",(function(e,t){e.mapInstance.getCanvas().style.cursor="",e.populationSquares.push(t),e.squarePopulationIsOpen=!0})),Object(M["a"])(n,"setSquarePopulationIsOpen",(function(e,t){e.squarePopulationIsOpen=t})),Object(M["a"])(n,J,(function(e,t){e.selectedMATSimLink=t})),Object(M["a"])(n,z,(function(e){e.selectedMATSimLink=[]})),Object(M["a"])(n,"setAffectedLinkIsOpen",(function(e,t){e.affectedLinkIsOpen=t})),n),Te={toggleSettingsVis:function(e){var t=e.state,a=e.commit;a(R,!t.mapSettingsIsOpen)},changeMapboxStyle:function(e,t){var a=e.commit,i=e.dispatch;i("clearMap"),a(P,t)},clearMap:function(e){var t=e.commit;t(F)},selectRegion:function(e,t){var a=e.dispatch,i=e.commit,n=e.getters;i(D,t),a("clearMap"),a("loadLayers"),i($,n.selectedRegion.center)},loadGlobal:{root:!0,handler:function(e){var t=e.dispatch;t("loadLayers")}},loadLayers:function(e){var t=e.dispatch,a=e.getters,i=a.selectedRegion;if(i){var n={sourceName:"matsim",pbfurl:"https://ees-server.now.sh"+i.matsimNetworkTiles,layerName:i.matsimNetworkLayer,sourceLayer:i.matsimNetworkLayer,paint:{"line-color":"#7777ff","line-width":.5},filter:["all"]};t("loadMATSimNetwork",n)}},loadMATSimNetwork:function(e,t){var a=e.commit;a(C),fetch("https://ees-server.now.sh/wake/please").then((function(){a(E)})),a(H,t),a(U,t),a(B,t.layerName);var i=JSON.parse(JSON.stringify(t));i=Object.assign(i,{layerName:t.layerName+"-highlighted",paint:{"line-color":"#FF8C00","line-width":1.5},filter:["in","ID",""]}),a(U,i),a(q,i.layerName);var n=JSON.parse(JSON.stringify(t));n=Object.assign(n,{layerName:t.layerName+"-highlightedDisruptions",paint:{"line-color":"#FF0000","line-width":1.5},filter:["in","ID",""]}),a(U,n),a(V,n.layerName);var o=JSON.parse(JSON.stringify(t));o=Object.assign(o,{layerName:t.layerName+"-selectedDisruptions",paint:{"line-color":"#00bfff","line-width":1.5},filter:["in","ID",""]}),a(U,o),a(W,o.layerName)}},ke={state:Se,getters:Oe,mutations:_e,actions:Te},Le=(a("6b54"),a("55dd"),a("75fc")),Ie=!0,we={stepMinutes:10,selectedFire:null,loadedLayers:[],loadedSources:[],visibleStep:null,fire3DFlameHeight:!1,opacity:.4,fireIntensityLevels:[[0,"#ffc107"],[1e5,"#dc3545"]]},xe={stepMinutes:function(e){return e.stepMinutes},visibleStep:function(e){return e.visibleStep},totalLayers:function(e){return e.loadedLayers.length},selectedFire:function(e,t,a,i){var n=i.fires;return e.selectedFire in n?n[e.selectedFire]:null},description:function(e,t){return e.selectedFire?t.selectedFire.description:""},ignitionMinutes:function(e,t){var a=t.selectedFire;return a&&"ignition_hhmm"in a?60*parseInt(a.ignition_hhmm.slice(0,2))+parseInt(a.ignition_hhmm.slice(2)):0},startStep:function(e,t){return t.ignitionMinutes/t.stepMinutes}},Ae=(o={},Object(M["a"])(o,Z,(function(e,t){e.selectedFire=t})),Object(M["a"])(o,oe,(function(e,t){var a=t.fireSlice,i=a.sourceName;t.map.addSource(i,{type:"geojson",data:a.geojson}),e.loadedSources.push(i)})),Object(M["a"])(o,re,(function(e,t){var a,i=t.fireSlice;a=e.fire3DFlameHeight?{id:i.layerName,type:"fill-extrusion",source:i.sourceName,filter:["has","FLAME_HT"],layout:{visibility:"none"},paint:{"fill-extrusion-color":{property:"E_INTSTY",stops:e.fireIntensityLevels},"fill-extrusion-height":{property:"FLAME_HT",stops:[[0,1],[300,1e3]]},"fill-extrusion-base":0,"fill-extrusion-opacity":e.opacity}}:{id:i.layerName,type:"fill",source:i.sourceName,layout:{visibility:"none"},paint:{"fill-color":{property:"E_INTSTY",stops:e.fireIntensityLevels},"fill-opacity":e.opacity}},t.map.addLayer(a,t.beforeLayer),e.loadedLayers.push(i.layerName)})),Object(M["a"])(o,se,(function(e,t){e.opacity=t})),Object(M["a"])(o,fe,(function(e,t){e.fire3DFlameHeight=t})),Object(M["a"])(o,Q,(function(e,t){var a=!0,i=!1,n=void 0;try{for(var o,r=e.loadedLayers[Symbol.iterator]();!(a=(o=r.next()).done);a=!0){var s=o.value;t.removeLayer(s)}}catch(f){i=!0,n=f}finally{try{a||null==r.return||r.return()}finally{if(i)throw n}}e.loadedLayers=[];var l=!0,c=!1,u=void 0;try{for(var p,d=e.loadedSources[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var m=p.value;t.removeSource(m)}}catch(f){c=!0,u=f}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}e.loadedSources=[],e.visibleStep=null,e.selectedFire=null})),Object(M["a"])(o,le,(function(e,t){e.visibleStep=t})),o),Me={clearMap:{root:!0,handler:function(e){var t=e.commit,a=e.rootGetters;t(Q,a.mapInstance)}},select:function(e,t){var a=e.dispatch,i=e.commit,n=e.getters,o=e.rootGetters;i(Q,o.mapInstance),i(Z,t);var r=n.selectedFire;n.selectedFire&&a("load"),r&&r.smokeGeojson&&a("drawSmoke",r.smokeGeojson)},loadGlobal:{root:!0,handler:function(e){var t=e.dispatch;t("load")}},load:function(e){var t=e.dispatch,a=e.getters,i=a.selectedFire;i&&t("downloadAndCreateLayers","https://ees-server.now.sh/"+i.file)},downloadAndCreateLayers:function(e,t){var a=e.dispatch,i=e.commit,n=e.getters,o=e.rootGetters,r=o.mapInstance;i(C,null,{root:!0}),fetch(t).then((function(e){return e.json()})).then((function(e){var t=Object(Le["a"])(e.features);t.sort((function(e,t){return null===e.properties.HOUR_BURNT?-1:null===t.properties.HOUR_BURNT?1:e.properties.HOUR_BURNT-t.properties.HOUR_BURNT}));var o=t[t.length-1],s=60*o.properties.HOUR_BURNT,l=Math.ceil(s/n.stepMinutes),c=0;while(null===t[c].properties.HOUR_BURNT)c++;for(var u=0;u<l;u++){var p=u*n.stepMinutes/60,d={type:"FeatureCollection",features:[]};while(t[c].properties.HOUR_BURNT<p)d.features.push(t[c]),c++;var m=u.toString(),f="phoenix-layer"+m,h="phoenix-source"+m;i(oe,{map:r,fireSlice:{sourceName:h,geojson:d}}),i(re,{map:r,beforeLayer:n.fireBeforeLayer,fireSlice:{sourceName:h,layerName:f}})}a("filter",n.startStep+l-1,{root:!0}),a("smoke/createLayers",e,{root:!0}),i(E,null,{root:!0})}))},filter:{root:!0,handler:function(e,t){for(var a=e.getters,i=e.rootGetters,n=e.commit,o=i.mapInstance,r=a.startStep,s=0;s<a.totalLayers;s++){var l="phoenix-layer"+s.toString();s+r<=t?o.setLayoutProperty(l,"visibility","visible"):o.setLayoutProperty(l,"visibility","none")}n(le,t)}},setOpacity:function(e,t){var a,i,n,o,r=e.getters,s=e.rootGetters,l=e.commit,c=s.mapInstance,u=r.totalLayers;for(l(se,t),o=we.fire3DFlameHeight?"fill-extrusion-opacity":"fill-opacity",a=0;a<u;a++)i=a.toString(),n="phoenix-layer"+i,c.setPaintProperty(n,o,t)},reload:{root:!0,handler:function(e){var t=e.dispatch;t("resetFireLayers")}},resetFireLayers:function(e){var t,a,i,n,o=e.dispatch,r=e.rootGetters,s=e.getters,l=e.commit,c=r.mapInstance,u=s.totalLayers;for(t=0;t<u;t++)a=t.toString(),i="phoenix-layer"+a,c.removeLayer(i);for(we.loadedLayers=[],t=0;t<u;t++)a=t.toString(),n="phoenix-source"+a,i="phoenix-layer"+a,l(re,{map:c,fireSlice:{sourceName:n,layerName:i}});o("filter",s.visibleStep,{root:!0})},toggleFireIn3D:function(e){var t=e.dispatch,a=e.state,i=e.commit;i(fe,!a.fire3DFlameHeight,{root:!0}),i(fe,!a.fire3DFlameHeight),t("resetFireLayers")}},Ce={namespaced:Ie,state:we,getters:xe,mutations:Ae,actions:Me},Ee=!0,je={color:"#000000",visible:!1,loadedLayers:[],loadedSources:[],opacity:.4},Ne={totalLayers:function(e){return e.loadedLayers.length}},Pe=(r={},Object(M["a"])(r,ce,(function(e,t){e.visible=t})),Object(M["a"])(r,ue,(function(e,t){var a=t.slice,i=a.sourceName;t.map.addSource(i,{type:"geojson",data:a.geojson}),e.loadedSources.push(i)})),Object(M["a"])(r,pe,(function(e,t){var a,i=t.slice;a={id:i.layerName,type:"fill",source:i.sourceName,layout:{visibility:"none"},paint:{"fill-color":e.color,"fill-opacity":e.opacity}},t.map.addLayer(a,t.beforeLayer),e.loadedLayers.push(i.layerName)})),Object(M["a"])(r,de,(function(e,t){e.opacity=t})),Object(M["a"])(r,me,(function(e,t){var a=!0,i=!1,n=void 0;try{for(var o,r=e.loadedLayers[Symbol.iterator]();!(a=(o=r.next()).done);a=!0){var s=o.value;t.removeLayer(s)}}catch(f){i=!0,n=f}finally{try{a||null==r.return||r.return()}finally{if(i)throw n}}e.loadedLayers=[];var l=!0,c=!1,u=void 0;try{for(var p,d=e.loadedSources[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var m=p.value;t.removeSource(m)}}catch(f){c=!0,u=f}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}e.loadedSources=[]})),r),Re={clearMap:{root:!0,handler:function(e){var t=e.commit,a=e.rootGetters;t(me,a.mapInstance)}},createLayers:function(e,t){var a=e.dispatch,i=e.commit,n=e.getters,o=e.rootGetters,r=o.mapInstance;i(me,r),i(C,null,{root:!0});var s=Object(Le["a"])(t.features);s.sort((function(e,t){return null===e.properties.HOUR_SPOT?-1:null===t.properties.HOUR_SPOT?1:e.properties.HOUR_SPOT-t.properties.HOUR_SPOT}));var l=s[s.length-1],c=60*l.properties.HOUR_SPOT,u=Math.ceil(c/o["fire/stepMinutes"]),p=0;while(null===s[p].properties.HOUR_SPOT)p++;for(var d=0;d<u;d++){var m=d*o["fire/stepMinutes"]/60,f={type:"FeatureCollection",features:[]};while(s[p].properties.HOUR_SPOT<m)f.features.push(s[p]),p++;var h=d.toString(),v="ember-layer"+h,y="ember-source"+h;i(ue,{map:r,slice:{sourceName:y,geojson:f}}),i(pe,{map:r,beforeLayer:n.smokeBeforeLayer,slice:{sourceName:y,layerName:v}})}a("filter",o["fire/visibleStep"],{root:!0}),i(E,null,{root:!0})},filter:{root:!0,handler:function(e,t){var a=e.state,i=e.getters,n=e.rootGetters;if(a.visible)for(var o=n.mapInstance,r=n["fire/startStep"],s=0;s<i.totalLayers;s++){var l="ember-layer"+s.toString();s+r<=t?o.setLayoutProperty(l,"visibility","visible"):o.setLayoutProperty(l,"visibility","none")}}},toggle:function(e,t){var a=e.getters,i=e.rootGetters,n=e.commit,o=e.dispatch;if(n(ce,t),t)o("filter",i["fire/visibleStep"],{root:!0});else for(var r=i.mapInstance,s=0;s<a.totalLayers;s++){var l="ember-layer"+s.toString();r.setLayoutProperty(l,"visibility","none")}},setOpacity:function(e,t){var a,i,n,o=e.getters,r=e.rootGetters,s=e.commit,l=r.mapInstance,c=o.totalLayers;s(de,t);var u="fill-opacity";for(a=0;a<c;a++)i=a.toString(),n="ember-layer"+i,l.setPaintProperty(n,u,t)},reload:{root:!0,handler:function(e){var t,a,i,n=e.rootGetters,o=e.getters,r=e.commit,s=n.mapInstance,l=o.totalLayers;for(t=0;t<l;t++)a=t.toString(),i="ember-layer"+a,s.removeLayer(i);for(je.loadedLayers=[],t=0;t<l;t++){a=t.toString();var c="ember-source"+a;i="ember-layer"+a,r(pe,{map:s,slice:{sourceName:c,layerName:i}})}}}},De={namespaced:Ee,state:je,getters:Ne,mutations:Pe,actions:Re},Fe=(a("456d"),!0),$e={selected:null,loadedLayers:[],loadedSources:[],opacity:1,activityColors:{home:"#fbb03b",work:"#223b53",beach:"#e55e5e",shops:"#3bb2d0",other:"#ccc"}},Ge={selected:function(e,t,a,i){var n=i.populations;return n&&e.selected in n?n[e.selected]:null},description:function(e,t){return e.selected?t.selected.description:""},totalLayers:function(e){return e.loadedLayers.length},aboveLayer:function(e,t,a){return a.firstSymbolLayer}},He=(s={},Object(M["a"])(s,ee,(function(e,t){e.selected=t})),Object(M["a"])(s,ae,(function(e,t){e.opacity=t})),Object(M["a"])(s,ie,(function(e,t){var a=t.popSlice,i=a.sourceName;t.map.addSource(i,{type:"geojson",data:a.geojson}),e.loadedSources.push(i)})),Object(M["a"])(s,ne,(function(e,t){var a,i=t.popSlice;a={id:i.layerName,type:"circle",source:i.sourceName,paint:{"circle-radius":{base:1.75,stops:[[12,2],[22,180]]},"circle-color":{type:"identity",property:"color"},"circle-opacity":e.opacity,"circle-opacity-transition":{duration:0}}},t.map.addLayer(a,t.beforeLayer),e.loadedLayers.push(i.layerName)})),Object(M["a"])(s,te,(function(e,t){var a=!0,i=!1,n=void 0;try{for(var o,r=e.loadedLayers[Symbol.iterator]();!(a=(o=r.next()).done);a=!0){var s=o.value;t.removeLayer(s)}}catch(f){i=!0,n=f}finally{try{a||null==r.return||r.return()}finally{if(i)throw n}}e.loadedLayers=[];var l=!0,c=!1,u=void 0;try{for(var p,d=e.loadedSources[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var m=p.value;t.removeSource(m)}}catch(f){c=!0,u=f}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}e.loadedSources=[],delete window.populationGeojson,e.selected=null})),s),Ue={clearMap:{root:!0,handler:function(e){var t=e.commit,a=e.rootGetters;t(te,a.mapInstance)}},select:function(e,t){var a=e.dispatch,i=e.getters,n=e.rootGetters,o=e.commit;o(te,n.mapInstance),o(ee,t),i.selected&&a("load")},loadGlobal:{root:!0,handler:function(e){var t=e.dispatch;t("load")}},load:function(e){var t=e.dispatch,a=e.getters;a.selected&&t("downloadAndCreateLayers","https://ees-server.now.sh/"+a.selected.file)},downloadAndCreateLayers:function(e,t){var a=e.state,i=e.dispatch,n=e.commit,o=e.rootGetters,r=o.mapInstance;n(C,null,{root:!0}),window.populationGeojson=[],fetch(t).then((function(e){return e.json()})).then((function(e){var t=e[e.length-1],s=60*t.end_hr,l=Math.ceil(s/o["fire/stepMinutes"]),c={},u=!0,p=!1,d=void 0;try{for(var m,f=e[Symbol.iterator]();!(u=(m=f.next()).done);u=!0){var h=m.value;h.id in c||(c[h.id]=h)}}catch(I){p=!0,d=I}finally{try{u||null==f.return||f.return()}finally{if(p)throw d}}for(var v=0,y=0;y<l;y++){var b=y*o["fire/stepMinutes"]/60;while(e[v].end_hr<b)c[e[v].id]=e[v],v++;for(var g={type:"FeatureCollection",features:[]},S=Object.keys(c),O=0;O<S.length;O++){var _=S[O],T={type:"Feature",properties:{person:c[_].id,end_hr:c[_].end_hr,type:c[_].type,color:a.activityColors[c[_].type]},geometry:{type:"Point",coordinates:[c[_].x,c[_].y]}};g.features.push(T)}window.populationGeojson.push(g)}var k="pop-layer",L="pop-source";n(ie,{map:r,popSlice:{sourceName:L,geojson:window.populationGeojson[0]}}),n(ne,{map:r,beforeLayer:o.fireBeforeLayer,popSlice:{sourceName:L,layerName:k}}),i("filter",l-1,{root:!0}),n(E,null,{root:!0})}))},filter:{root:!0,handler:function(e,t){var a=e.rootGetters,i=a.mapInstance,n=i.getSource("pop-source");"undefined"!==typeof n&&n.setData(window.populationGeojson[t])}},setOpacity:function(e,t){var a=e.rootGetters,i=e.commit,n=a.mapInstance,o="pop-layer";i(ae,t),n.setPaintProperty(o,"circle-opacity",t)},reload:{root:!0,handler:function(e){var t,a=e.rootGetters,i=e.commit,n=a.mapInstance;t="pop-layer",n.removeLayer(t),$e.loadedLayers=[];var o="pop-source";i(ne,{map:n,popSlice:{sourceName:o,layerName:t}})}}},Be={namespaced:Fe,state:$e,getters:Ge,mutations:He,actions:Ue},qe={savedSettingsJson:null,simulationName:null,simSettingsIsOpen:!1},We={},Ve=(l={},Object(M["a"])(l,X,(function(e,t){e.savedSettingsJson=t,fetch("https://ees-server.now.sh/save-settings",{method:"POST",body:JSON.stringify(t),headers:{"content-type":"application/json"}}).then((function(e){return e})).then((function(e){if(e.details){var t=e.details.map((function(e){return e.message})).join(". ");console.log(t)}else console.log(e)}))})),Object(M["a"])(l,K,(function(e,t){e.simSettingsIsOpen=t})),Object(M["a"])(l,"setSimulationName",(function(e,t){e.simulationName=t})),l),Ye={},Je={state:qe,getters:We,mutations:Ve,actions:Ye};c["default"].use(A["a"]);var ze=new A["a"].Store({modules:{config:ge,map:ke,fire:Ce,smoke:De,population:Be,simulation:Je}}),Xe={name:"maplayer",data:function(){return{disruptionSelected:!1}},computed:Object(g["a"])({},Object(A["d"])({mapboxAccessToken:function(e){return e.config.mapboxAccessToken},mapboxStyle:function(e){return e.map.mapboxStyle},mapCenter:function(e){return e.map.mapCenter},mapInstance:function(e){return e.map.mapInstance},baseMATSimLayer:function(e){return e.map.baseMATSimLayer},highlightMATSimLayer:function(e){return e.map.highlightMATSimLayer},disruptionMATSimLayer:function(e){return e.map.disruptionMATSimLayer},selectedDisruptionMATSimLayer:function(e){return e.map.selectedDisruptionMATSimLayer}}),{mapOpts:function(){var e={style:"mapbox://styles/mapbox/"+this.mapboxStyle+"-v9",center:this.mapCenter,minZoom:0,zoom:6,maxZoom:18};return e}}),components:{mapbox:_["a"]},methods:{storeMapInstance:function(e){e.on("click",this.mapOnClick),e.on("draw.create",this.squareCreated),e.on("style.load",this.loadLayersOnStyleChange);var t=new I.a({displayControlsDefault:!1,modes:Object.assign({draw_rectangle:x.a},I.a.modes)});e.addControl(t),ze.commit(j,e),ze.commit(N,t),ze.commit(G)},loadLayersOnStyleChange:function(){ze.commit(G),ze.dispatch("loadGlobal")},squareCreated:function(e){var t=e.features[0];ze.commit("addPopulationSquare",t)},mapOnClick:function(e){var t,a=this,i=""==ze.state.map.selectedMATSimLink?[]:ze.state.map.selectedMATSimLink,n=[[e.point.x-5,e.point.y-5],[e.point.x+5,e.point.y+5]],o=this.mapInstance.queryRenderedFeatures(n,{layers:[this.baseMATSimLayer]});if("undefined"!=typeof o&&0!==o.length){var r=o[0].geometry.coordinates.slice()[0][0],s=o[0].properties.ID,l=i.filter((function(e){return e!==s}));i.length!=l.length?i=l:i.push(s);var c=[],u="<strong>Link</strong>: "+s,p=!1;i.forEach((function(e){ze.state.map.disruptions.forEach((function(e){if(e.affectedLinks.includes(s)&&(p=!0,ze.commit(J,[s]),i=ze.state.map.selectedMATSimLink,a.disruptionSelected=!0,p)){var t=e.absoluteSpeed?" km/h":"% Slower";u+="<br><strong>Description</strong>: "+e.description+"<br><strong>Time</strong>: "+e.start+"-"+e.end+"<br><strong>Speed</strong>: "+e.speed+t+"<br><strong>Affected Links: </strong>:<br>",c=e.affectedLinks,e.affectedLinks.forEach((function(e){u+=e+"<br>"}))}})),a.disruptionSelected&&0==p&&(ze.commit(J,[s]),i=ze.state.map.selectedMATSimLink,a.disruptionSelected=!1)})),t=o.reduce((function(e,t){return p?c.forEach((function(t){e.push(t)})):i.forEach((function(t){e.push(t)})),e}),["in","ID"]),(new k.a.Popup).setLngLat(r).setHTML(u).addTo(this.mapInstance),ze.commit(J,i)}else t=["in","ID",""],ze.commit(z,i);var d=["in","ID",""],m=["in","ID",""];p?d=t:m=t,this.mapInstance.setFilter(this.selectedDisruptionMATSimLayer,d),this.mapInstance.setFilter(this.highlightMATSimLayer,m)}}},Ke=Xe,Ze=(a("3153"),Object(d["a"])(Ke,S,O,!1,null,"30161512",null)),Qe=Ze.exports,et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.visibleStep||0===e.visibleStep?a("div",{staticClass:"time-slider-overlay"},[a("div",{staticClass:"time-slider-overlay-inner"},[a("vue-slider",e._b({ref:"fireslider",attrs:{marks:e.hasLabel,tooltip:"always","tooltip-formatter":e.stepToTime,"use-keyboard":!0},scopedSlots:e._u([{key:"label",fn:function(t){var i=t.active,n=t.value;return[a("div",{class:["vue-slider-mark-label","custom-label",{active:i}]},[e._v("\n          "+e._s(e.stepToTime(n))+"\n        ")])]}}],null,!1,3544431226),model:{value:e.timeStep,callback:function(t){e.timeStep=t},expression:"timeStep"}},"vue-slider",e.sliderConfig,!1))],1)]):e._e()},tt=[],at=(a("f576"),a("4971")),it=a.n(at),nt=(a("24df"),{name:"mapSlider",components:{VueSlider:it.a},props:{},data:function(){var e=[];return e["sm"]=36,e["md"]=24,e["lg"]=6,{labelStep:e}},computed:Object(g["a"])({},Object(A["d"])({fireStepMinutes:function(e){return e.fire.stepMinutes},visibleStep:function(e){return e.fire.visibleStep},fireSliderTicks:function(e){return e.fire.fireSliderTicks}}),{sliderConfig:function(){return{width:"98%",value:this.visibleStep?this.visibleStep:0,min:0,max:this.maxSteps}},timeStep:{get:function(){return this.visibleStep},set:function(e){this.$store.dispatch("filter",e)}},maxSteps:function(){return 1440/this.fireStepMinutes}}),methods:{hasLabel:function(e){var t=this.labelStep[this.$mq],a=e<this.maxSteps-t+1;return e%t===0&&a||e===this.maxSteps-1},stepToTime:function(e){return Math.floor(10*e/60).toString()+":"+(10*e%60).toString().padStart(2,"0")}}}),ot=nt,rt=(a("24f5"),Object(d["a"])(ot,et,tt,!1,null,null,null)),st=rt.exports,lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return null!=e.popSelected?a("div",{staticClass:"legend-overlay"},[a("div",{staticClass:"legend-overlay-inner"},[a("table",{attrs:{id:"pop-legend",cellspacing:"3px"}},e._l(e.activityColors,(function(t,i){return a("tr",{key:i},[a("td",{style:{backgroundColor:t}},[e._v("Â ")]),a("td",{staticClass:"p-2"},[e._v(e._s(i))])])})),0)])]):e._e()},ct=[],ut={name:"mapPopLegend",props:{},data:function(){return{}},computed:Object(g["a"])({},Object(A["d"])({activityColors:function(e){return e.population.activityColors}}),Object(A["c"])({popSelected:"population/selected"})),methods:{}},pt=ut,dt=(a("3126"),Object(d["a"])(pt,lt,ct,!1,null,null,null)),mt=dt.exports,ft=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"map-settings-container"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpen,expression:"isOpen"}],staticClass:"map-overlay"},[a("div",{staticClass:"map-population-panel"},[a("label",{attrs:{for:"map-population"}},[e._v("Population inside square:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.squarePopulation,expression:"squarePopulation"}],attrs:{id:"map-population",type:"text"},domProps:{value:e.squarePopulation},on:{input:function(t){t.target.composing||(e.squarePopulation=t.target.value)}}}),a("button",{staticClass:"icon",attrs:{type:"button"},on:{click:function(t){return e.toggle()}}},[e._v("Save")])])]),a("div",{attrs:{id:"map-link-panel"}})])},ht=[],vt=(a("c5f6"),{name:"mapSquarePopulation",props:{squarePopulation:{default:0,type:Number}},computed:{isOpen:{get:function(){return this.$store.state.map.squarePopulationIsOpen},set:function(e){this.$store.commit("setSquarePopulationIsOpen",e)}}},methods:{toggle:function(){this.$store.commit("setSquarePopulationIsOpen",!this.$store.state.map.squarePopulationIsOpen)}}}),yt=vt,bt=(a("9d64"),Object(d["a"])(yt,ft,ht,!1,null,null,null)),gt=bt.exports,St=function(){var e=this,t=e.$createElement,a=e._self._c||t;return 0!==e.isLoading?a("div",{staticClass:"load-spinner-overlay"},[e._m(0)]):e._e()},Ot=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"load-spinner-overlay-inner"},[a("span",{staticClass:"loading"})])}],_t={name:"mapSpinner",props:{},computed:Object(g["a"])({},Object(A["d"])({isLoading:function(e){return e.map.isLoading}}))},Tt=_t,kt=(a("1570"),Object(d["a"])(Tt,St,Ot,!1,null,null,null)),Lt=kt.exports,It=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{directives:[{name:"show",rawName:"v-show",value:null!=this.$store.state.map.mapInstance&&(null!=this.$store.state.config.data||null!=this.error)&&this.$store.state.map.mapSettingsIsOpen,expression:"\n    this.$store.state.map.mapInstance != null &&\n      (this.$store.state.config.data != null || this.error != null) &&\n      this.$store.state.map.mapSettingsIsOpen\n  "}],staticClass:"p-0 h-100 mapboxgl-ctrl-top-left map-sidebar-container",attrs:{fluid:""}},[a("b-row",{staticClass:"h-100",attrs:{"no-gutters":""}},[a("b-col",{staticClass:"h-100 m-0 pt-2 mapboxgl-ctrl map-sidebar-col",attrs:{sm:"5"}},[a("div",{attrs:{id:"h-100 nav"}},[a("h5",[e._v("Emergency Evacuation Simulator")]),a("router-link",{attrs:{to:"/"}},[e._v("Home")]),e._v(" |\n        "),a("router-link",{attrs:{to:"/about"}},[e._v("About")])],1),a("b-collapse",{staticClass:"h-100",attrs:{visible:"",id:"collapse-side-panel"}},[a("div",{staticClass:"h-100 map-accordion-container"},[null!=this.error?a("b-alert",{attrs:{show:"",variant:"danger"},domProps:{innerHTML:e._s(this.error)}}):e._e(),a("b-card",{staticClass:"mb-1 p-0",attrs:{header:"Scenario"}},[a("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"4",label:"Region","label-for":"map-region"}},[a("b-form-select",{attrs:{id:"map-region"},model:{value:e.selectedRegion,callback:function(t){e.selectedRegion=t},expression:"selectedRegion"}},[a("option",{attrs:{value:"any-region"}},[e._v("(any)")]),e._l(e.regions,(function(t,i){return a("option",{key:i,attrs:{disabled:e.selectedRegion==i},domProps:{value:i}},[e._v(e._s(t.name))])}))],2)],1),a("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"4",label:"Population","label-for":"map-population",description:e.popDesc}},[a("b-form-select",{attrs:{id:"map-population"},model:{value:e.selectedPopulation,callback:function(t){e.selectedPopulation=t},expression:"selectedPopulation"}},[a("option",{attrs:{value:"no-population"}},[e._v("None")]),e._l(e.popInSelectedRegion,(function(t,i){return a("option",{key:i,attrs:{disabled:e.selectedPopulation==i},domProps:{value:i}},[e._v(e._s(t.display_name))])}))],2)],1)],1),a("b-card",{staticClass:"mb-1",scopedSlots:e._u([{key:"header",fn:function(){return[a("h6",{staticClass:"mb-0"},[e._v("\n                Emergency Incident\n                "),a("span",{staticClass:"helper-icons"},[a("FontAwesomeIcon",{directives:[{name:"b-popover",rawName:"v-b-popover.hover",value:e.helperOptions[0].text,expression:"helperOptions[0].text",modifiers:{hover:!0}}],attrs:{icon:"info-circle"}})],1)])]},proxy:!0}])},[a("b-collapse",{attrs:{visible:"",id:"collapse-incident"}},[a("b-form",{attrs:{inline:""}},[a("b-form-select",{attrs:{id:"map-fire"},model:{value:e.selectedFire,callback:function(t){e.selectedFire=t},expression:"selectedFire"}},[a("option",{attrs:{value:"no-fire",disabled:""}}),e._l(e.firesInSelectedRegion,(function(t,i){return a("option",{key:i,attrs:{disabled:e.selectedFire==i},domProps:{value:i}},[e._v(e._s(t.display_name))])}))],2),a("b-form-checkbox",{staticClass:"ml-2 form-check-input",attrs:{disabled:null==this.$store.state.fire.selectedFire},model:{value:e.showSmoke,callback:function(t){e.showSmoke=t},expression:"showSmoke"}},[e._v("Display Embers\n                ")])],1),a("div",{staticClass:"p-2"},[e._v(e._s(e.eventDesc))])],1)],1),a("MapTrafficBehaviourCard",{attrs:{helpText:e.helperOptions[3].text,trafficSpeed:100}}),a("b-card",{staticClass:"mb-1",attrs:{header:"UI Settings"}},[a("b-collapse",{attrs:{visible:"",id:"collapse-map-style"}},[a("b-form",[a("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"8",label:"Map Style","label-for":"map-style"}},[a("b-form-select",{attrs:{id:"map-style"},model:{value:e.mapboxStyle,callback:function(t){e.mapboxStyle=t},expression:"mapboxStyle"}},e._l(e.styles,(function(t){return a("option",{key:t.id,attrs:{disabled:e.mapboxStyle.id==t.id},domProps:{value:t.id}},[e._v(e._s(t.name))])})),0)],1),a("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"8",label:"Fire Opacity","label-for":"fire_opacity"}},[a("b-form-input",{attrs:{id:"fire_opacity",type:"number",value:"0.7",step:"0.1",min:"0",max:"1",disabled:null==this.$store.state.fire.selectedFire},model:{value:e.fireOpacity,callback:function(t){e.fireOpacity=t},expression:"fireOpacity"}})],1),a("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"8",label:"Smoke Opacity","label-for":"smoke_opacity"}},[a("b-form-input",{attrs:{id:"smoke_opacity",type:"number",value:"0.5",step:"0.1",min:"0",max:"1",disabled:null==this.$store.state.fire.selectedFire},model:{value:e.smokeOpacity,callback:function(t){e.smokeOpacity=t},expression:"smokeOpacity"}})],1),a("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"8",label:"Population Opacity","label-for":"population_opacity"}},[a("b-form-input",{attrs:{id:"population_opacity",type:"number",value:"0.5",step:"0.1",min:"0",max:"1"},model:{value:e.popOpacity,callback:function(t){e.popOpacity=t},expression:"popOpacity"}})],1)],1)],1)],1),a("br"),a("br"),a("br")],1)])],1)],1)],1)},wt=[],xt=(a("28a5"),a("4917"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"map-link-panel"},[a("b-form-group",{attrs:{label:"MATSim Link ID:","label-for":"map-link"}},[a("b-form-input",{attrs:{id:"map-link",type:"text",placeholder:"Please select a MATSim Network Link from the map",readonly:""},model:{value:e.linkId,callback:function(t){e.linkId=t},expression:"linkId"}})],1),a("b-form-group",{attrs:{label:"Disruption Start Time:","label-for":"map-link-start"}},[a("b-form-input",{attrs:{id:"map-link-start",type:"text"},model:{value:e.linkStart,callback:function(t){e.linkStart=t},expression:"linkStart"}})],1),a("button",{staticClass:"icon",attrs:{type:"button"},on:{click:function(t){return e.toggle()}}},[e._v("Save")])],1)}),At=[],Mt={name:"mapAffectedLink",props:{linkId:{default:"",type:String},linkStart:{default:"00:00",type:String}},computed:{isOpen:{get:function(){return this.$store.state.map.affectedLinkIsOpen},set:function(e){this.$store.commit("setAffectedLinkIsOpen",e)}}},methods:{toggle:function(){this.$store.commit("setAffectedLinkIsOpen",!this.$store.state.map.affectedLinkIsOpen)}}},Ct=Mt,Et=(a("11d8"),Object(d["a"])(Ct,xt,At,!1,null,null,null)),jt=Et.exports,Nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-card",{staticClass:"mb-1",attrs:{header:"Traffic Behaviour Setup"}},[a("b-collapse",{attrs:{visible:"",id:"collapse-traffic"}},[a("label",[e._v("\n      Maximum speed on roads (as % of speed limits)\n      "),a("span",{staticClass:"helper-icons"},[a("FontAwesomeIcon",{directives:[{name:"b-popover",rawName:"v-b-popover.hover",value:e.helpText,expression:"helpText",modifiers:{hover:!0}}],attrs:{icon:"info-circle"}})],1)]),a("div",{staticClass:"traffic-slider"},[a("vue-slider",e._b({ref:"trafficslider",attrs:{interval:10,tooltip:"always","tooltip-formatter":e.valueToPercent,marks:e.valueToMark,"drag-on-click":!0},model:{value:e.trafficSpeed,callback:function(t){e.trafficSpeed=t},expression:"trafficSpeed"}},"vue-slider",e.sliderConfig,!1))],1)])],1)},Pt=[],Rt=a("ecee"),Dt=a("c074"),Ft=a("ad3d");Rt["c"].add(Dt["b"]);var $t={name:"mapTrafficCard",components:{VueSlider:it.a,FontAwesomeIcon:Ft["a"]},props:["trafficSpeed","helpText"],data:function(){var e=this;return{sliderConfig:{min:0,max:100,dotStyle:{display:"none"}},valueToPercent:function(e){return"".concat(e,"%")},valueToMark:function(t){return{label:t%100===0?e.valueToPercent(t):""}}}}},Gt=$t,Ht=(a("793f"),Object(d["a"])(Gt,Nt,Pt,!1,null,null,null)),Ut=Ht.exports;Rt["c"].add(Dt["c"],Dt["b"],Dt["d"]),c["default"].config.productionTip=!1;var Bt={name:"mapSetup",props:{},data:function(){return{isHidden:!1,styles:this.$store.state.config.styles,populations:this.$store.state.config.populations,modalShow:!1,global:[{text:"startHHMM",value:"00:00"}],phoenix:[{text:"ignitionHHMM",value:"00:00"},{text:"fireGeoJson",value:"scenarios/surf-coast-shire/test-files/scenario_fire.json"},{text:"smokeGeoJson",value:""}],matsim:[{text:"outputDir",value:"test/output/io/github/agentsoz/ees//TypicalSummerWeekday50kTest/testTypicalSummerWeekday50k/matsim"},{text:"configXml",value:"scenarios/surf-coast-shire/test-files/scenario_matsim_main.xml"},{text:"maxDistanceForFireVisual",value:"1000"},{text:"maxDistanceForSmokeVisual",value:"5000"},{text:"fireAvoidanceBufferForVehicles",value:"5000"},{text:"fireAvoidanceBufferForEmergencyVehicles",value:"1000"},{text:"congestionEvaluationInterval",value:"180"},{text:"congestionToleranceThreshold",value:"0.33"},{text:"congestionReactionProbability",value:"0.0"}],trafficBehaviour:[{text:"proportion",value:"0.0"},{text:"radiusInMtrs",value:"0"}],dest_selected:null,dest_options:[{value:null,text:"Please select an option"}],helperOptions:[{value:0,text:"If the location chosen has fire models, choose which one to use. Select whether to show visually on map.\nEvacuation can proceed without fire model, in which case No incident should be selected. If a fire model is selected, key attributes are displayed."},{value:1,text:"Evac start is the time at which evacuation starts (announcement is made).\nIf there is a fire model, this should be some time after fire ignition attribute of chosen fire.\nEvac peak is the length of time after the start, at which the largest number of people are starting to leave.\nEvacuations are dispersed around the peak point."},{value:2,text:"Potential destinations are indicated in location file. These provide direction of evacuation. If multiple destinations are given, evacuation is split between these (currently an equal split - future work will allow user specification).\nThe safe line is a line beyond which evacuees can be considered out of danger. Safe lines should be sufficiently long to cut all possible roads that could be used to a given destination. Only one safe line is allowed per destination. To draw line, click start point, release, click end point."},{value:3,text:"The simulator will modify speeds based on congestion. However in a bushfire additional factors (e.g. smoke) may affect possible speed. This allows that to be specified as a % of the normal speed. The setting will affect all roads in the network, not only those near the fire."}]}},computed:Object(g["a"])({},Object(A["d"])({populationSquares:function(e){return e.map.populationSquares},selectedMATSimLink:function(e){return e.map.selectedMATSimLink},visibleStep:function(e){return e.fire.visibleStep},error:function(e){return e.config.error}}),Object(A["c"])(["mapInstance","regions","selectedStyle","selectedRegion","popInSelectedRegion"]),Object(A["c"])({popDesc:"population/description",eventDesc:"fire/description"}),{firesInSelectedRegion:function(){return this.$store.getters.firesInSelectedRegion?this.$store.getters.firesInSelectedRegion:[]},mapboxStyle:{get:function(){return this.$store.state.map.mapboxStyle},set:function(e){this.changeMapboxStyle(e)}},selectedRegion:{get:function(){return this.$store.state.map.selectedRegion?this.$store.state.map.selectedRegion:"no-region"},set:function(e){this.selectRegion(e)}},selectedPopulation:{get:function(){return this.$store.state.population.selected?this.$store.state.population.selected:"no-population"},set:function(e){this["population/select"](e)}},selectedFire:{get:function(){return this.$store.state.fire.selectedFire?this.$store.state.fire.selectedFire:"no-fire"},set:function(e){this["fire/select"](e)}},selectedIncident:{get:function(){return["fire"]}},showSmoke:{get:function(){return this.$store.state.smoke.smokeVisible},set:function(e){this["smoke/toggle"](e)}},fireOpacity:{get:function(){return this.$store.state.fire.opacity},set:function(e){var t=/^[-+]?[0-9]+\.[0-9]+$/;e.match(t)&&this.$store.dispatch("fire/setOpacity",parseFloat(e))}},smokeOpacity:{get:function(){return this.$store.state.smoke.opacity},set:function(e){var t=/^[-+]?[0-9]+\.[0-9]+$/;e.match(t)&&this.$store.dispatch("smoke/setOpacity",parseFloat(e))}},popOpacity:{get:function(){return this.$store.state.population.opacity},set:function(e){var t=/^[-+]?[0-9]+\.[0-9]+$/;e.match(t)&&this.$store.dispatch("population/setOpacity",parseFloat(e))}}}),components:{mapAffectedLink:jt,MapTrafficBehaviourCard:Ut,FontAwesomeIcon:Ft["a"]},methods:Object(g["a"])({},Object(A["b"])(["selectRegion","changeMapboxStyle","fire/select","smoke/toggle","population/select"]),{setRegion:function(e){this.selectRegion(e.target.dataset.region)},drawRectangle:function(){this.$store.commit("drawPopulationSquare")},toggle:function(){this.isHidden=!this.isHidden},changeTime:function(e){if(4==e.length){if(":"==e.charAt(2)){var t=new Array;t=e.split(":"),t[0]<=12&&t[1]<=59&&(this.evac_time=t[0]+":"+t[1])}}else this.evac_time="0:00"}})},qt=Bt,Wt=(a("a69a"),Object(d["a"])(qt,It,wt,!1,null,null,null)),Vt=Wt.exports,Yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"map-settings-container",on:{"!keydown":function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.toggle()}}},[a("div",{staticClass:"map-settings-hamburger mapboxgl-ctrl-top-left"},[a("button",{staticClass:"pt-2 pb-1 px-3 mapboxgl-ctrl mapboxgl-ctrl-group",attrs:{type:"button"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.toggle()},click:function(t){return e.toggle()}}},[a("FontAwesomeIcon",{attrs:{icon:"bars",size:"2x"}})],1)]),a("div",{staticClass:"map-settings-button-container mapboxgl-ctrl-top-right",attrs:{"z-index":"10000"}},[a("div",{staticClass:"mapboxgl-ctrl mapboxgl-ctrl-group"},[a("button",{staticClass:"icon polygon",attrs:{type:"button"},on:{click:function(t){return e.drawRectangle()}}})]),a("div",{staticClass:"mapboxgl-ctrl mapboxgl-ctrl-group"},[a("button",{class:{"font-weight-bold":e.renderFireIn3D},attrs:{type:"button"},on:{click:function(t){return e.toggleFireIn3D()}}},[e._v("\n        3D\n      ")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:""!=this.$store.state.map.selectedMATSimLink||this.showDisruptionWindow,expression:"\n        this.$store.state.map.selectedMATSimLink != '' ||\n          this.showDisruptionWindow\n      "}],staticClass:"mapboxgl-ctrl mapboxgl-ctrl-group"},[a("button",{staticClass:"icon bug",style:this.showDisruptionWindow?"background-color: lightskyblue;":"",attrs:{type:"button"},on:{click:function(t){e.showDisruptionWindow=!e.showDisruptionWindow}}})])]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showDisruptionWindow,expression:"showDisruptionWindow"}],staticClass:"map-overlay"},[e.isLinkDisrupted()?a("div",{staticClass:"save-simulation-panel"},[a("h3",[e._v("Disruption")]),a("button",{staticClass:"btn btn-danger",staticStyle:{width:"100% !important"},on:{click:function(t){return e.deleteDisruption()}}},[e._v("\n        Delete\n      ")])]):a("div",{staticClass:"save-simulation-panel"},[a("h3",[e._v("Disruption")]),a("label",{staticClass:"form-label",attrs:{id:"status1"}},[e._v("Description")]),a("input",{ref:"description",attrs:{id:"simulation-name",placeholder:"",type:"text"}}),a("div",{staticClass:"container"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"}),a("div",{staticClass:"col"},[e._v("\n            Start Time\n            "),a("input",{ref:"startTime",staticClass:"form-control",attrs:{type:"time",value:"00:00:00",id:"example-time-input"}})]),a("div",{staticClass:"col"},[e._v("\n            End Time\n            "),a("input",{ref:"endTime",staticClass:"form-control",attrs:{type:"time",value:"00:00:00",id:"example-time-input"}})]),a("div",{staticClass:"col-4"},[e._v("\n            Speed\n            "),a("div",{staticClass:"input-group"},[a("input",{ref:"speed",staticClass:"form-control",staticStyle:{"text-align":"right"},attrs:{type:"number",placeholder:"Speed","aria-label":"Recipient's username","aria-describedby":"basic-addon2"}}),a("div",{staticClass:"input-group-append"},[a("button",{class:e.absoluteSpeed?"btn btn-primary":"btn btn-secondary",attrs:{type:"button"},on:{click:function(t){e.absoluteSpeed=!0}}},[e._v("\n                  KM/H\n                ")]),a("button",{class:e.absoluteSpeed?"btn btn-secondary":"btn btn-primary",attrs:{type:"button"},on:{click:function(t){e.absoluteSpeed=!1}}},[e._v("\n                  %\n                ")])])])]),a("div",{staticClass:"col"})])]),a("label",{staticClass:"form-label",attrs:{id:"status1"}},[e._v("Affected Links")]),a("input",{staticStyle:{"margin-bottom":"10px"},attrs:{id:"simulation-name",type:"text",disabled:""},domProps:{value:this.$store.state.map.selectedMATSimLink}}),""!=this.$store.state.map.selectedMATSimLink?a("button",{staticClass:"btn btn-success",staticStyle:{width:"100% !important"},on:{click:function(t){return e.saveDisruption()}}},[e._v("\n        Save\n      ")]):a("button",{staticClass:"btn btn-success",staticStyle:{width:"100% !important"},attrs:{disabled:""},on:{click:function(t){return e.saveDisruption()}}},[e._v("\n        Save\n      ")])])])])},Jt=[];Rt["c"].add(Dt["a"]);var zt={name:"mapButtons",props:{},components:{FontAwesomeIcon:Ft["a"]},data:function(){return{absoluteSpeed:!0,showDisruptionWindow:!1,styles:this.$store.state.config.styles,regions:this.$store.state.config.regions}},computed:{renderFireIn3D:{get:function(){return this.$store.state.fire.fire3DFlameHeight}}},methods:Object(g["a"])({},Object(A["b"])({toggleFireIn3D:"fire/toggleFireIn3D",toggle:"toggleSettingsVis"}),{drawRectangle:function(){this.$store.commit("drawPopulationSquare")},saveDisruption:function(){var e=this.$store,t=e.state.map.mapInstance,a={affectedLinks:e.state.map.selectedMATSimLink,start:this.$refs.startTime.value,end:this.$refs.endTime.value,description:this.$refs.description.value,speed:this.$refs.speed.value,absoluteSpeed:this.absoluteSpeed},i=["in","ID"];e.commit(Y,a),e.state.map.disruptions.forEach((function(e){e.affectedLinks.forEach((function(e){i.push(e)}))})),t.setFilter(e.state.map.disruptionMATSimLayer,i),this.showDisruptionWindow=!1,e.state.map.selectedMATSimLink=""},isLinkDisrupted:function(){var e=this.$store.state.map.selectedMATSimLink,t=this.$store.state.map.disruptions,a=!1;return t.forEach((function(t){t.affectedLinks.forEach((function(t){t==e&&(a=!0)}))})),a},deleteDisruption:function(){var e=this.$store.state.map.selectedMATSimLink,t=this.$store.state.map.disruptions,a=this.$store,i=["in","ID"];this.showDisruptionWindow=!1,t.forEach((function(a,i){a.affectedLinks.forEach((function(a){a==e&&delete t[i]}))})),a.state.map.mapInstance.setFilter(a.state.map.selectedDisruptionMATSimLayer,i),t.forEach((function(e){e.affectedLinks.forEach((function(e){i.push(e)}))})),a.state.map.mapInstance.setFilter(a.state.map.disruptionMATSimLayer,i),a.commit(z,null)}})},Xt=zt,Kt=(a("a003"),Object(d["a"])(Xt,Yt,Jt,!1,null,null,null)),Zt=Kt.exports,Qt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"save-map-settings-container"},[a("b-button",{attrs:{variant:"outline-primary",id:"save-map-settings-toggle"},on:{click:e.SaveSimulationToggle}},[e._v("Save")]),a("b-button",{attrs:{variant:"outline-primary",id:"create-simulation"}},[e._v("Create")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.simSettingsIsOpen,expression:"simSettingsIsOpen"}],staticClass:"map-overlay"},[a("div",{staticClass:"save-simulation-panel"},[a("label",{attrs:{for:"simulation-name"}},[e._v("Simulation Name:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.simulationName,expression:"simulationName"}],attrs:{id:"simulation-name",type:"text"},domProps:{value:e.simulationName},on:{input:function(t){t.target.composing||(e.simulationName=t.target.value)}}}),a("b-button",{attrs:{variant:"outline-primary",id:"save-map-settings"},on:{click:e.SaveSimulationConfig}},[e._v("Save")]),a("b-button",{attrs:{variant:"outline-primary",id:"cancel-map-settings"},on:{click:e.SaveSimulationToggle}},[e._v("Cancel")])],1)])],1)},ea=[],ta={name:"saveSettings",props:{toggle:{default:!1,type:Boolean}},data:function(){return{}},computed:Object(g["a"])({},Object(A["d"])({simSettingsIsOpen:function(e){return e.simulation.simSettingsIsOpen}}),Object(A["c"])(["selectedRegion","selectedFire"]),{simulationName:{get:function(){return this.$store.state.simulation.simulationName},set:function(e){this.$store.commit("setSimulationName",e)}}}),methods:{SaveSimulationToggle:function(){this.$store.commit(K,!this.saveSimIsOpen)},SaveSimulationConfig:function(){var e={simulationName:this.simulationName,config:{ees:[{global:[{randomSeed:"1234",crs:"EPSG:28355",startHHMM:"00:00"}],bdi:[{jPlanSelectionPolicy:"FIRST",jAgents:"",jLogLevel:"WARN",jLogFile:"test/output/io/github/agentsoz/ees/TypicalSummerWeekday50kTest/testTypicalSummerWeekday50k/jill.log",jOutFile:"test/output/io/github/agentsoz/ees//TypicalSummerWeekday50kTest/testTypicalSummerWeekday50k/jill.out"}],matsim:[{outputDir:"test/output/io/github/agentsoz/ees//TypicalSummerWeekday50kTest/testTypicalSummerWeekday50k/matsim",configXml:"scenarios/surf-coast-shire/typical-summer-weekday-50k/scenario_matsim_main.xml",maxDistanceForFireVisual:"1000",maxDistanceForSmokeVisual:"5000",fireAvoidanceBufferForVehicles:"5000",fireAvoidanceBufferForEmergencyVehicles:"1000",congestionEvaluationInterval:"180",congestionToleranceThreshold:"0.33",congestionReactionProbability:"0.0"}],phoenix:[{ignitionHHMM:"00:00",fireGeoJson:this.selectedFire.geojson,smokeGeoJson:""}],disruption:[{fileJson:"scenarios/surf-coast-shire/typical-summer-weekday-50k/scenario_disruptions.json"}],messaging:[{fileJson:"scenarios/surf-coast-shire/typical-summer-weekday-50k/scenario_messages.json"}]}],scenario_main:[{matsimfile:"scenarios/surf-coast-shire/typical-summer-weekday-50k/scenario_matsim_main.xml",firefile:[{name:"",coordinates:"",format:""}],geographyfile:[{geo_name:"scenarios/surf-coast-shire/typical-summer-weekday-50k/scenario_geography.xml"}],trafficBehaviour:[{proportion:"0.0",radiusInMtrs:"0"}],evacuationTiming:[{start:"00:00",peak:"00"}],bdiagents:"bdiagents"}]}};this.$store.commit(X,e,this.simulationName),this.SaveSimulationToggle()}}},aa=ta,ia=(a("940b"),Object(d["a"])(aa,Qt,ea,!1,null,null,null)),na=ia.exports,oa={name:"home",components:{maplayer:Qe,slider:st,popLegend:mt,spinner:Lt,population:gt,setup:Vt,buttons:Zt,savesettings:na},methods:Object(g["a"])({},Object(A["b"])(["toggleSettingsVis"]))},ra=oa,sa=Object(d["a"])(ra,y,b,!1,null,null,null),la=sa.exports;c["default"].use(v["a"]);var ca=new v["a"]({routes:[{path:"/",name:"home",component:la},{path:"/about",name:"about",component:function(){return a.e("about").then(a.bind(null,"f820"))}}]}),ua=a("5f5b"),pa=(a("f9e3"),a("2dd8"),a("660e"));c["default"].use(ua["a"]),c["default"].use(pa["a"]),c["default"].config.productionTip=!1,new c["default"]({el:"#app",router:ca,store:ze,render:function(e){return e(h)},mounted:function(){this.$store.dispatch("getConfig","https://ees-server.now.sh/config")}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";var i=a("e332"),n=a.n(i);n.a},"6c7f":function(e,t,a){},"793f":function(e,t,a){"use strict";var i=a("6c7f"),n=a.n(i);n.a},"826e":function(e,t,a){},"8b15":function(e,t,a){},"8eaf":function(e,t,a){},"940b":function(e,t,a){"use strict";var i=a("0dc4"),n=a.n(i);n.a},"98bd":function(e,t,a){},"9c29":function(e,t,a){},"9d64":function(e,t,a){"use strict";var i=a("4658"),n=a.n(i);n.a},a003:function(e,t,a){"use strict";var i=a("8eaf"),n=a.n(i);n.a},a69a:function(e,t,a){"use strict";var i=a("98bd"),n=a.n(i);n.a},e332:function(e,t,a){}});
//# sourceMappingURL=app.eff85e96.js.map