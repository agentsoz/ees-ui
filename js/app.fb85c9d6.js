(function(e){function t(t){for(var a,o,s=t[0],l=t[1],c=t[2],u=0,p=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);d&&d(t);while(p.length)p.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,o=1;o<n.length;o++){var s=n[o];0!==i[s]&&(a=!1)}a&&(r.splice(t--,1),e=l(l.s=n[0]))}return e}var a={},o={app:0},i={app:0},r=[];function s(e){return l.p+"js/"+({about:"about",output:"output"}[e]||e)+"."+{about:"404cba23",output:"e58a2878"}[e]+".js"}function l(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.e=function(e){var t=[],n={about:1,output:1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=new Promise((function(t,n){for(var a="css/"+({about:"about",output:"output"}[e]||e)+"."+{about:"e8a3e408",output:"cdfc593a"}[e]+".css",i=l.p+a,r=document.getElementsByTagName("link"),s=0;s<r.length;s++){var c=r[s],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===a||u===i))return t()}var p=document.getElementsByTagName("style");for(s=0;s<p.length;s++){c=p[s],u=c.getAttribute("data-href");if(u===a||u===i)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var a=t&&t.target&&t.target.src||i,r=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=a,delete o[e],d.parentNode.removeChild(d),n(r)},d.href=i;var f=document.getElementsByTagName("head")[0];f.appendChild(d)})).then((function(){o[e]=0})));var a=i[e];if(0!==a)if(a)t.push(a[2]);else{var r=new Promise((function(t,n){a=i[e]=[t,n]}));t.push(a[2]=r);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=s(e);var p=new Error;c=function(t){u.onerror=u.onload=null,clearTimeout(d);var n=i[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",p.name="ChunkLoadError",p.type=a,p.request=o,n[1](p)}i[e]=void 0}};var d=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(t)},l.m=e,l.c=a,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(n,a,function(t){return e[t]}.bind(null,a));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/ees-ui/",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var p=0;p<c.length;p++)t(c[p]);var d=u;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0a6f":function(e,t,n){"use strict";var a=n("e996"),o=n.n(a);o.a},"0dc4":function(e,t,n){},"0ebb":function(e,t,n){},"11d8":function(e,t,n){"use strict";var a=n("50f0"),o=n.n(a);o.a},1570:function(e,t,n){"use strict";var a=n("826e"),o=n.n(a);o.a},"24f5":function(e,t,n){"use strict";var a=n("9c29"),o=n.n(a);o.a},3126:function(e,t,n){"use strict";var a=n("0ebb"),o=n.n(a);o.a},4360:function(e,t,n){"use strict";var a,o,i,r,s,l,c,u=n("2b0e"),p=n("2f62"),d=(n("ac6a"),n("456d"),n("bd86")),f=(n("6762"),n("2fdb"),n("9fb0")),m={mapboxAccessToken:"pk.eyJ1IjoiZGhpeHNpbmdoIiwiYSI6ImNqbWx4OTR0ZzBkMWUzb255and1aTUweGkifQ.U0vPiwyfM4ad7axC_4dkHg",error:null,data:null,styles:[{id:"basic",name:"Basic"},{id:"bright",name:"Bright"},{id:"dark",name:"Dark"},{id:"light",name:"Light"},{id:"satellite",name:"Satellite"},{id:"streets",name:"Streets"}]},h={mapboxAccessToken:function(e){return e.mapboxAccessToken},styles:function(e){return e.styles},regions:function(e){return e.data?e.data.tiles:{}},populations:function(e){return e.data?e.data.populations:{}},outputs:function(e){return e.data?e.data.outputs:{}},fires:function(e){return e.data?e.data.fires:{}},region:function(e){return function(t){return e.data.tiles[t]}},populationsWithTag:function(e,t){return function(e){var n=t.populations,a={};for(var o in n)Array.isArray(n[o].tags)&&n[o].tags.includes(e)&&(a[o]=n[o]);return a}},firesWithTag:function(e,t){return function(e){var n=t.fires,a={};for(var o in n)Array.isArray(n[o].tags)&&n[o].tags.includes(e)&&(a[o]=n[o]);return a}}},y=(a={},Object(d["a"])(a,"SAVE_SETTINGS",(function(e,t){e.data=t})),Object(d["a"])(a,"ERROR",(function(e,t){e.error=t})),a),v={getConfig:function(e,t){var n=e.commit,a=e.getters;n(f["M"]),fetch(t).then((function(e){return e.json()})).then((function(e){n(f["e"]),n("SAVE_SETTINGS",e);var t=[];0==Object.keys(a.populations).length&&t.push("populations"),0==Object.keys(a.fires).length&&t.push("fires"),0==Object.keys(a.outputs).length&&t.push("simulation outputs"),t.length>0&&n("ERROR","The server did not return any "+t.join(" or ")+" for use.<br />The server may currently be downloading resources. Please refresh the page after about a minute.")})).catch((function(e){n("ERROR","Could not retreive anything from the server. Please try again later.<br />Tried URL: "+t+"<br /><br /> Error message below.<br /><br />"+e),n(f["e"])}))}},b={state:m,getters:h,mutations:y,actions:v},g=(n("ac4d"),n("8a81"),n("7f7fd"),n("7514"),{isLoading:0,mapboxStyle:"dark",firstSymbolLayer:null,featureSetPlacementOrder:["region","fire","smoke","population","output"],featureSetPlaceholderLayerId:{},mapSettingsIsOpen:!0,baseMATSimLayer:null,highlightMATSimLayer:null,loadedMATSimLayers:[],loadedMATSimSource:null,selectedRegion:null,populationSquares:[],squarePopulationIsOpen:!1,selectedMATSimLink:"",disruptions:[],affectedLinkIsOpen:!1,mapInstance:null,drawInstance:null,mapCenter:[144.968447,-37.818232]}),S={mapInstance:function(e){return e.mapInstance},drawInstance:function(e){return e.drawInstance},selectedStyle:function(e,t,n){if(!e.mapboxStyle)return null;var a=n.config.styles,o=a.find((function(t){return t.id===e.mapboxStyle}));return o},featureSetPlaceholderLayerId:function(e){return e.featureSetPlaceholderLayerId},selectedRegion:function(e,t,n,a){if(!e.selectedRegion)return null;var o=a.region(e.selectedRegion);return"undefined"===typeof o?null:o},popInSelectedRegion:function(e,t,n,a){return null===t.selectedRegion?t.populations:a.populationsWithTag(t.selectedRegion.name)},firesInSelectedRegion:function(e,t,n,a){return null===t.selectedRegion?t.fires:a.firesWithTag(t.selectedRegion.name)}},O=(o={},Object(d["a"])(o,f["M"],(function(e){e.isLoading++})),Object(d["a"])(o,f["e"],(function(e){e.isLoading>0&&e.isLoading--})),Object(d["a"])(o,f["L"],(function(e,t){e.mapInstance=t})),Object(d["a"])(o,f["J"],(function(e,t){e.drawInstance=t})),Object(d["a"])(o,f["K"],(function(e,t){e.mapboxStyle=t,e.mapInstance.setStyle("mapbox://styles/mapbox/"+e.mapboxStyle+"-v9")})),Object(d["a"])(o,f["I"],(function(e,t){e.mapSettingsIsOpen=t})),Object(d["a"])(o,f["H"],(function(e,t){e.selectedRegion=t})),Object(d["a"])(o,f["s"],(function(e,t){e.baseMATSimLayer=t})),Object(d["a"])(o,f["u"],(function(e,t){e.highlightMATSimLayer=t})),Object(d["a"])(o,f["t"],(function(e,t){e.disruptionMATSimLayer=t})),Object(d["a"])(o,f["v"],(function(e,t){e.selectedDisruptionMATSimLayer=t})),Object(d["a"])(o,f["k"],(function(e,t){e.disruptions.push(t)})),Object(d["a"])(o,f["j"],(function(e,t){e.mapInstance.flyTo({center:t,zoom:8,bearing:0,speed:.5,curve:1,easing:function(e){return e}}),e.mapCenter=t})),Object(d["a"])(o,f["N"],(function(e,t){t?e.mapInstance.easeTo({pitch:60}):e.mapInstance.easeTo({pitch:0})})),Object(d["a"])(o,f["m"],(function(e){for(var t,n=e.mapInstance.getStyle().layers,a=0;a<n.length;a++)if("symbol"===n[a].type&&n[a].id.includes("label")){t=n[a].id;break}e.firstSymbolLayer=t;var o={type:"FeatureCollection",features:[]};e.mapInstance.addSource("placeholder",{type:"geojson",data:o});var i=!0,r=!1,s=void 0;try{for(var l,c=e.featureSetPlacementOrder[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value,p=u+"-placeholder";e.mapInstance.addLayer({id:p,type:"line",source:"placeholder",layout:{visibility:"none"}},e.firstSymbolLayer),e.featureSetPlaceholderLayerId[u]=p}}catch(d){r=!0,s=d}finally{try{i||null==c.return||c.return()}finally{if(r)throw s}}})),Object(d["a"])(o,f["l"],(function(e,t){e.mapInstance.addLayer({id:t.layerName,type:"line",source:t.sourceName,"source-layer":t.sourceLayer,minzoom:0,maxzoom:22,paint:t.paint,filter:t.filter},e.featureSetPlaceholderLayerId["region"]),e.loadedMATSimLayers.push(t.layerName)})),Object(d["a"])(o,f["n"],(function(e,t){e.mapInstance.addSource(t.sourceName,{type:"vector",tiles:[t.pbfurl],minzoom:0,maxzoom:14}),e.loadedMATSimSource=t.sourceName})),Object(d["a"])(o,f["c"],(function(e){var t=e.mapInstance,n=!0,a=!1,o=void 0;try{for(var i,r=e.loadedMATSimLayers[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var s=i.value;t.removeLayer(s)}}catch(l){a=!0,o=l}finally{try{n||null==r.return||r.return()}finally{if(a)throw o}}e.loadedMATSimLayers=[],e.loadedMATSimSource&&(t.removeSource(e.loadedMATSimSource),e.loadedMATSimSource=null),e.baseMATSimLayer=null,e.highlightMATSimLayer=null})),Object(d["a"])(o,"drawPopulationSquare",(function(e){var t=e.mapInstance,n=e.drawInstance;n.changeMode("draw_rectangle"),t.getCanvas().style.cursor="crosshair"})),Object(d["a"])(o,"addPopulationSquare",(function(e,t){e.mapInstance.getCanvas().style.cursor="",e.populationSquares.push(t),e.squarePopulationIsOpen=!0})),Object(d["a"])(o,"setSquarePopulationIsOpen",(function(e,t){e.squarePopulationIsOpen=t})),Object(d["a"])(o,f["q"],(function(e,t){e.selectedMATSimLink=t})),Object(d["a"])(o,f["o"],(function(e){e.selectedMATSimLink=[]})),Object(d["a"])(o,"setAffectedLinkIsOpen",(function(e,t){e.affectedLinkIsOpen=t})),o),_={toggleSettingsVis:function(e){var t=e.state,n=e.commit;n(f["I"],!t.mapSettingsIsOpen)},changeMapboxStyle:function(e,t){var n=e.commit,a=e.dispatch;a("clearMap"),n(f["K"],t)},clearMap:function(e){var t=e.commit;t(f["c"])},selectRegion:function(e,t){var n=e.dispatch,a=e.commit,o=e.getters,i=e.state;i.selectedRegion!=t&&(null!==o.selectedRegion&&n("clearMap"),a(f["H"],t),null!=o.selectedRegion&&(n("loadLayers"),a(f["j"],o.selectedRegion.center)))},selectRelevantRegion:function(e,t){var n=e.dispatch,a=(e.commit,e.getters),o=!0,i=!1,r=void 0;try{e:for(var s,l=t[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;for(var u in a.regions)if(c==a.regions[u].name){n("selectRegion",u);break e}}}catch(p){i=!0,r=p}finally{try{o||null==l.return||l.return()}finally{if(i)throw r}}},loadGlobal:{root:!0,handler:function(e){var t=e.getters,n=e.dispatch;t.mapInstance;n("loadLayers")}},loadLayers:function(e){var t=e.dispatch,n=e.getters,a=n.selectedRegion;if(a){var o={sourceName:"matsim",pbfurl:"https://ees-server.now.sh"+a.matsimNetworkTiles,layerName:a.matsimNetworkLayer,sourceLayer:a.matsimNetworkLayer,paint:{"line-color":"#7777ff","line-width":.5},filter:["all"]};t("loadMATSimNetwork",o)}},loadMATSimNetwork:function(e,t){var n=e.commit;n(f["M"]),fetch("https://ees-server.now.sh/wake/please").then((function(){n(f["e"])})),n(f["n"],t),n(f["l"],t),n(f["s"],t.layerName);var a=JSON.parse(JSON.stringify(t));a=Object.assign(a,{layerName:t.layerName+"-highlighted",paint:{"line-color":"#FF8C00","line-width":1.5},filter:["in","ID",""]}),n(f["l"],a),n(f["u"],a.layerName);var o=JSON.parse(JSON.stringify(t));o=Object.assign(o,{layerName:t.layerName+"-highlightedDisruptions",paint:{"line-color":"#FF0000","line-width":1.5},filter:["in","ID",""]}),n(f["l"],o),n(f["t"],o.layerName);var i=JSON.parse(JSON.stringify(t));i=Object.assign(i,{layerName:t.layerName+"-selectedDisruptions",paint:{"line-color":"#00bfff","line-width":1.5},filter:["in","ID",""]}),n(f["l"],i),n(f["v"],i.layerName)}},L={state:g,getters:S,mutations:O,actions:_},T=(n("6b54"),n("55dd"),n("75fc")),k=!0,I={stepMinutes:10,selectedFire:null,loadedLayers:[],loadedSources:[],visibleStep:null,fire3DFlameHeight:!1,opacity:.4,fireIntensityLevels:[[0,"#ffc107"],[1e5,"#dc3545"]]},w={stepMinutes:function(e){return e.stepMinutes},visibleStep:function(e){return e.visibleStep},totalLayers:function(e){return e.loadedLayers.length},selectedFire:function(e,t,n,a){var o=a.fires;return e.selectedFire in o?o[e.selectedFire]:null},description:function(e,t){return null!==t.selectedFire?t.selectedFire.description:""},ignitionMinutes:function(e,t){var n=t.selectedFire;return n&&"ignition_hhmm"in n?60*parseInt(n.ignition_hhmm.slice(0,2))+parseInt(n.ignition_hhmm.slice(2)):0},startStep:function(e,t){return t.ignitionMinutes/t.stepMinutes}},x=(i={},Object(d["a"])(i,f["F"],(function(e,t){e.selectedFire=t})),Object(d["a"])(i,f["x"],(function(e,t){var n=t.fireSlice,a=n.sourceName;t.map.addSource(a,{type:"geojson",data:n.geojson}),e.loadedSources.push(a)})),Object(d["a"])(i,f["w"],(function(e,t){var n,a=t.fireSlice;n=e.fire3DFlameHeight?{id:a.layerName,type:"fill-extrusion",source:a.sourceName,filter:["has","FLAME_HT"],layout:{visibility:"none"},paint:{"fill-extrusion-color":{property:"E_INTSTY",stops:e.fireIntensityLevels},"fill-extrusion-height":{property:"FLAME_HT",stops:[[0,1],[300,1e3]]},"fill-extrusion-base":0,"fill-extrusion-opacity":e.opacity}}:{id:a.layerName,type:"fill",source:a.sourceName,layout:{visibility:"none"},paint:{"fill-color":{property:"E_INTSTY",stops:e.fireIntensityLevels},"fill-opacity":e.opacity}},t.map.addLayer(n,t.beforeLayer),e.loadedLayers.push(a.layerName)})),Object(d["a"])(i,f["y"],(function(e,t){e.opacity=t})),Object(d["a"])(i,f["N"],(function(e,t){e.fire3DFlameHeight=t})),Object(d["a"])(i,f["a"],(function(e,t){var n=!0,a=!1,o=void 0;try{for(var i,r=e.loadedLayers[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var s=i.value;t.removeLayer(s)}}catch(m){a=!0,o=m}finally{try{n||null==r.return||r.return()}finally{if(a)throw o}}e.loadedLayers=[];var l=!0,c=!1,u=void 0;try{for(var p,d=e.loadedSources[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var f=p.value;t.removeSource(f)}}catch(m){c=!0,u=m}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}e.loadedSources=[],e.visibleStep=null,e.selectedFire=null})),Object(d["a"])(i,f["z"],(function(e,t){e.visibleStep=t})),i),A={clearMap:{root:!0,handler:function(e){var t=e.commit,n=e.rootGetters;t(f["a"],n.mapInstance)}},select:function(e,t){var n=e.dispatch,a=e.commit,o=e.getters,i=e.rootGetters;a(f["a"],i.mapInstance),a("smoke/CLEAR_SMOKE",i.mapInstance,{root:!0}),a(f["F"],t);var r=o.selectedFire;r&&(n("load"),null==i.selectedRegion&&r.tags&&n("selectRelevantRegion",r.tags,{root:!0}),r.smokeGeojson&&n("drawSmoke",r.smokeGeojson))},loadGlobal:{root:!0,handler:function(e){var t=e.dispatch;t("load")}},load:function(e){var t=e.dispatch,n=e.getters,a=n.selectedFire;a&&t("downloadAndCreateLayers","https://ees-server.now.sh/"+a.file)},downloadAndCreateLayers:function(e,t){var n=e.dispatch,a=e.commit,o=e.getters,i=e.rootGetters,r=i.mapInstance;a(f["M"],null,{root:!0}),fetch(t).then((function(e){return e.json()})).then((function(e){var t=Object(T["a"])(e.features);t.sort((function(e,t){return null===e.properties.HOUR_BURNT?-1:null===t.properties.HOUR_BURNT?1:e.properties.HOUR_BURNT-t.properties.HOUR_BURNT}));var s=t[t.length-1],l=60*s.properties.HOUR_BURNT,c=Math.ceil(l/o.stepMinutes),u=0;while(null===t[u].properties.HOUR_BURNT)u++;for(var p=0;p<c;p++){var d=p*o.stepMinutes/60,m={type:"FeatureCollection",features:[]};while(t[u].properties.HOUR_BURNT<d)m.features.push(t[u]),u++;var h=p.toString(),y="phoenix-layer"+h,v="phoenix-source"+h;a(f["x"],{map:r,fireSlice:{sourceName:v,geojson:m}}),a(f["w"],{map:r,beforeLayer:i.featureSetPlaceholderLayerId["fire"],fireSlice:{sourceName:v,layerName:y}})}n("filter",o.startStep+c-1,{root:!0}),n("smoke/createLayers",e,{root:!0}),a(f["e"],null,{root:!0})}))},filter:{root:!0,handler:function(e,t){for(var n=e.getters,a=e.rootGetters,o=e.commit,i=a.mapInstance,r=n.startStep,s=0;s<n.totalLayers;s++){var l="phoenix-layer"+s.toString();s+r<=t?i.setLayoutProperty(l,"visibility","visible"):i.setLayoutProperty(l,"visibility","none")}o(f["z"],t)}},setOpacity:function(e,t){var n,a,o,i,r=e.getters,s=e.rootGetters,l=e.commit,c=s.mapInstance,u=r.totalLayers;for(l(f["y"],t),i=I.fire3DFlameHeight?"fill-extrusion-opacity":"fill-opacity",n=0;n<u;n++)a=n.toString(),o="phoenix-layer"+a,c.setPaintProperty(o,i,t)},reload:{root:!0,handler:function(e){var t=e.dispatch;t("resetFireLayers")}},resetFireLayers:function(e){var t,n,a,o,i=e.dispatch,r=e.rootGetters,s=e.getters,l=e.commit,c=r.mapInstance,u=s.totalLayers;for(t=0;t<u;t++)n=t.toString(),a="phoenix-layer"+n,c.removeLayer(a);for(I.loadedLayers=[],t=0;t<u;t++)n=t.toString(),o="phoenix-source"+n,a="phoenix-layer"+n,l(f["w"],{map:c,fireSlice:{sourceName:o,layerName:a}});i("filter",s.visibleStep,{root:!0})},toggleFireIn3D:function(e){var t=e.dispatch,n=e.state,a=e.commit;a(f["N"],!n.fire3DFlameHeight,{root:!0}),a(f["N"],!n.fire3DFlameHeight),t("resetFireLayers")}},M={namespaced:k,state:I,getters:w,mutations:x,actions:A},j=!0,C={color:"#f3172d",visible:!1,loadedLayers:[],loadedSources:[],opacity:.4},E={totalLayers:function(e){return e.loadedLayers.length}},N=(r={},Object(d["a"])(r,f["f"],(function(e,t){e.visible=t})),Object(d["a"])(r,f["h"],(function(e,t){var n=t.slice,a=n.sourceName;t.map.addSource(a,{type:"geojson",data:n.geojson}),e.loadedSources.push(a)})),Object(d["a"])(r,f["g"],(function(e,t){var n,a=t.slice;n={id:a.layerName,type:"fill",source:a.sourceName,layout:{visibility:"none"},paint:{"fill-color":e.color,"fill-opacity":e.opacity}},t.map.addLayer(n,t.beforeLayer),e.loadedLayers.push(a.layerName)})),Object(d["a"])(r,f["i"],(function(e,t){e.opacity=t})),Object(d["a"])(r,f["d"],(function(e,t){var n=!0,a=!1,o=void 0;try{for(var i,r=e.loadedLayers[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var s=i.value;t.removeLayer(s)}}catch(m){a=!0,o=m}finally{try{n||null==r.return||r.return()}finally{if(a)throw o}}e.loadedLayers=[];var l=!0,c=!1,u=void 0;try{for(var p,d=e.loadedSources[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var f=p.value;t.removeSource(f)}}catch(m){c=!0,u=m}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}e.loadedSources=[]})),r),P={clearMap:{root:!0,handler:function(e){var t=e.commit,n=e.rootGetters;t(f["d"],n.mapInstance)}},createLayers:function(e,t){var n=e.dispatch,a=e.commit,o=(e.getters,e.rootGetters),i=o.mapInstance;a(f["d"],i),a(f["M"],null,{root:!0});var r=Object(T["a"])(t.features);r.sort((function(e,t){return null===e.properties.HOUR_SPOT?-1:null===t.properties.HOUR_SPOT?1:e.properties.HOUR_SPOT-t.properties.HOUR_SPOT}));var s=r[r.length-1],l=60*s.properties.HOUR_SPOT,c=Math.ceil(l/o["fire/stepMinutes"]),u=0;while(null===r[u].properties.HOUR_SPOT)u++;for(var p=0;p<c;p++){var d=p*o["fire/stepMinutes"]/60,m={type:"FeatureCollection",features:[]};while(r[u].properties.HOUR_SPOT<d)m.features.push(r[u]),u++;var h=p.toString(),y="ember-layer"+h,v="ember-source"+h;a(f["h"],{map:i,slice:{sourceName:v,geojson:m}}),a(f["g"],{map:i,beforeLayer:o.featureSetPlaceholderLayerId["smoke"],slice:{sourceName:v,layerName:y}})}n("filter",o["fire/visibleStep"],{root:!0}),a(f["e"],null,{root:!0})},filter:{root:!0,handler:function(e,t){var n=e.state,a=e.getters,o=e.rootGetters;if(n.visible)for(var i=o.mapInstance,r=o["fire/startStep"],s=0;s<a.totalLayers;s++){var l="ember-layer"+s.toString();s+r<=t?i.setLayoutProperty(l,"visibility","visible"):i.setLayoutProperty(l,"visibility","none")}}},toggle:function(e,t){var n=e.getters,a=e.rootGetters,o=e.commit,i=e.dispatch;if(o(f["f"],t),t)i("filter",a["fire/visibleStep"],{root:!0});else for(var r=a.mapInstance,s=0;s<n.totalLayers;s++){var l="ember-layer"+s.toString();r.setLayoutProperty(l,"visibility","none")}},setOpacity:function(e,t){var n,a,o,i=e.getters,r=e.rootGetters,s=e.commit,l=r.mapInstance,c=i.totalLayers;s(f["i"],t);var u="fill-opacity";for(n=0;n<c;n++)a=n.toString(),o="ember-layer"+a,l.setPaintProperty(o,u,t)},reload:{root:!0,handler:function(e){var t,n,a,o=e.rootGetters,i=e.getters,r=e.commit,s=o.mapInstance,l=i.totalLayers;for(t=0;t<l;t++)n=t.toString(),a="ember-layer"+n,s.removeLayer(a);for(C.loadedLayers=[],t=0;t<l;t++){n=t.toString();var c="ember-source"+n;a="ember-layer"+n,r(f["g"],{map:s,slice:{sourceName:c,layerName:a}})}}}},R={namespaced:j,state:C,getters:E,mutations:N,actions:P},D=!0,F={selected:null,loadedLayers:[],loadedSources:[],opacity:1,activityColors:["#fbb03b","#223b53","#e55e5e","#3bb2d0","#cccccc"],currActivities:{}},$={selected:function(e,t,n,a){var o=a.populations;return o&&e.selected in o?o[e.selected]:null},currActivities:function(e){return e.currActivities},description:function(e,t){return null!==t.selected?t.selected.description:""},totalLayers:function(e){return e.loadedLayers.length},aboveLayer:function(e,t,n){return n.firstSymbolLayer}},G=(s={},Object(d["a"])(s,f["G"],(function(e,t){e.selected=t})),Object(d["a"])(s,f["A"],(function(e,t){e.opacity=t})),Object(d["a"])(s,f["D"],(function(e,t){var n={};t.sort();for(var a=0;a<t.length;a++)if(a<e.activityColors.length)n[t[a]]=e.activityColors[a];else{var o=Math.floor(Math.abs(16777215*Math.sin(a))%16777215);o=o.toString(16);while(o.length<6)o="0"+o;n[t[a]]="#"+o,e.activityColors.push("#"+o)}e.currActivities=n})),Object(d["a"])(s,f["E"],(function(e,t){var n=t.id,a=t.color;e.activityColors[n]!=a&&(e.activityColors[n]=a)})),Object(d["a"])(s,f["C"],(function(e,t){var n=t.popSlice,a=n.sourceName;t.map.addSource(a,{type:"geojson",data:n.geojson}),e.loadedSources.push(a)})),Object(d["a"])(s,f["B"],(function(e,t){var n,a=t.popSlice;n={id:a.layerName,type:"circle",source:a.sourceName,paint:{"circle-radius":{base:1.75,stops:[[12,2],[22,180]]},"circle-color":{type:"identity",property:"color"},"circle-opacity":e.opacity,"circle-opacity-transition":{duration:0}}},t.map.addLayer(n,t.beforeLayer),e.loadedLayers.push(a.layerName)})),Object(d["a"])(s,f["b"],(function(e,t){var n=!0,a=!1,o=void 0;try{for(var i,r=e.loadedLayers[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var s=i.value;t.removeLayer(s)}}catch(m){a=!0,o=m}finally{try{n||null==r.return||r.return()}finally{if(a)throw o}}e.loadedLayers=[];var l=!0,c=!1,u=void 0;try{for(var p,d=e.loadedSources[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var f=p.value;t.removeSource(f)}}catch(m){c=!0,u=m}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}e.loadedSources=[],delete window.populationGeojson,e.selected=null,e.currActivities={}})),s),H={clearMap:{root:!0,handler:function(e){var t=e.commit,n=e.rootGetters;t(f["b"],n.mapInstance)}},select:function(e,t){var n=e.dispatch,a=e.getters,o=e.rootGetters,i=e.commit;i(f["b"],o.mapInstance),i(f["G"],t),a.selected&&(n("load"),null==o.selectedRegion&&a.selected.tags&&n("selectRelevantRegion",a.selected.tags,{root:!0}))},loadGlobal:{root:!0,handler:function(e){var t=e.dispatch;t("load")}},load:function(e){var t=e.dispatch,n=e.getters;n.selected&&t("downloadAndCreateLayers","https://ees-server.now.sh/"+n.selected.file)},downloadAndCreateLayers:function(e,t){var n=e.state,a=e.dispatch,o=e.commit,i=e.rootGetters,r=i.mapInstance;o(f["M"],null,{root:!0}),window.populationGeojson=[],fetch(t).then((function(e){return e.json()})).then((function(e){var t=e[e.length-1],s=60*t.end_hr,l=Math.ceil(s/i["fire/stepMinutes"]),c={},u=[],p=!0,d=!1,m=void 0;try{for(var h,y=e[Symbol.iterator]();!(p=(h=y.next()).done);p=!0){var v=h.value;v.id in c||(c[v.id]=v),u.includes(v.type)||u.push(v.type)}}catch(x){d=!0,m=x}finally{try{p||null==y.return||y.return()}finally{if(d)throw m}}o(f["D"],u);for(var b=0,g=0;g<l;g++){var S=g*i["fire/stepMinutes"]/60;while(e[b].end_hr<S)c[e[b].id]=e[b],b++;for(var O={type:"FeatureCollection",features:[]},_=Object.keys(c),L=0;L<_.length;L++){var T=_[L],k={type:"Feature",properties:{person:c[T].id,end_hr:c[T].end_hr,type:c[T].type,color:n.currActivities[c[T].type]},geometry:{type:"Point",coordinates:[c[T].x,c[T].y]}};O.features.push(k)}window.populationGeojson.push(O)}var I="pop-layer",w="pop-source";o(f["C"],{map:r,popSlice:{sourceName:w,geojson:window.populationGeojson[0]}}),o(f["B"],{map:r,beforeLayer:i.featureSetPlaceholderLayerId["population"],popSlice:{sourceName:w,layerName:I}}),a("filter",l-1,{root:!0}),o(f["e"],null,{root:!0})}))},filter:{root:!0,handler:function(e,t){var n=e.rootGetters,a=n.mapInstance,o=a.getSource("pop-source");"undefined"!==typeof o&&o.setData(window.populationGeojson[t])}},changeActivityColor:function(e,t){var n=e.state,a=e.dispatch,o=e.commit,i=t.id,r=t.color;n.activityColors[i]!=r&&(o(f["E"],{id:i,color:r}),a("select",n.selected))},setOpacity:function(e,t){var n=e.rootGetters,a=e.commit,o=n.mapInstance,i="pop-layer";a(f["A"],t),o.setPaintProperty(i,"circle-opacity",t)},reload:{root:!0,handler:function(e){var t,n=e.rootGetters,a=e.commit,o=n.mapInstance;t="pop-layer",o.removeLayer(t),F.loadedLayers=[];var i="pop-source";a(f["B"],{map:o,popSlice:{sourceName:i,layerName:t}})}}},B={namespaced:D,state:F,getters:$,mutations:G,actions:H},q={savedSettingsJson:null,simulationName:null,simSettingsIsOpen:!1},U={},W=(l={},Object(d["a"])(l,f["p"],(function(e,t){e.savedSettingsJson=t,fetch("https://ees-server.now.sh/save-settings",{method:"POST",body:JSON.stringify(t),headers:{"content-type":"application/json"}}).then((function(e){return e})).then((function(e){if(e.details){var t=e.details.map((function(e){return e.message})).join(". ");console.log(t)}else console.log(e)}))})),Object(d["a"])(l,f["r"],(function(e,t){e.simSettingsIsOpen=t})),Object(d["a"])(l,"setSimulationName",(function(e,t){e.simulationName=t})),l),V={},J={state:q,getters:U,mutations:W,actions:V},Y=!0,z={stepSeconds:60,stepMinutes:1,visibleStep:0,selected:null,loadedLayers:[],loadedSources:[],opacity:1,activityColors:{home:"#fbb03b",work:"#223b53",beach:"#e55e5e",shops:"#3bb2d0",other:"#ccc"}},K={stepMinutes:function(e){return e.stepMinutes},stepSeconds:function(e){return e.stepSeconds},selected:function(e,t,n,a){var o=a.populations;return o&&e.selected in o?o[e.selected]:null},description:function(e,t){return e.selected?t.selected.description:""},totalLayers:function(e){return e.loadedLayers.length},aboveLayer:function(e,t,n){return n.firstSymbolLayer}},X=(c={},Object(d["a"])(c,"SET_VISIBLE_STEP",(function(e,t){e.visibleStep=t})),Object(d["a"])(c,f["G"],(function(e,t){e.selected=t})),Object(d["a"])(c,f["A"],(function(e,t){e.opacity=t})),Object(d["a"])(c,f["C"],(function(e,t){var n=t.popSlice,a=n.sourceName;t.map.addSource(a,{type:"geojson",data:n.geojson}),e.loadedSources.push(a)})),Object(d["a"])(c,f["B"],(function(e,t){var n,a=t.popSlice;n={id:a.layerName,type:"circle",source:a.sourceName,paint:{"circle-radius":{base:1.75,stops:[[12,2],[22,180]]},"circle-color":{property:"v",stops:[[0,"#ffffff"],[25,"#ff0000"]]},"circle-opacity":e.opacity,"circle-opacity-transition":{duration:0}}},t.map.addLayer(n,t.beforeLayer),e.loadedLayers.push(a.layerName)})),Object(d["a"])(c,f["b"],(function(e,t){var n=!0,a=!1,o=void 0;try{for(var i,r=e.loadedLayers[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var s=i.value;t.removeLayer(s)}}catch(m){a=!0,o=m}finally{try{n||null==r.return||r.return()}finally{if(a)throw o}}e.loadedLayers=[];var l=!0,c=!1,u=void 0;try{for(var p,d=e.loadedSources[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var f=p.value;t.removeSource(f)}}catch(m){c=!0,u=m}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}e.loadedSources=[],delete window.populationGeojson,e.selected=null})),c),Z={clearMap:{root:!0,handler:function(e){var t=e.commit,n=e.rootGetters;t(f["b"],n.mapInstance)}},select:function(e,t){var n=e.dispatch,a=e.getters,o=e.rootGetters,i=e.commit;i(f["b"],o.mapInstance),i(f["G"],t),a.selected&&n("load")},loadGlobal:{root:!0,handler:function(e){var t=e.dispatch;t("selectRegion","surf_coast_shire_network",{root:!0}),t("fire/select","Anglesea_evac_test_ffdi104_phx5_2016data_minsup_fh2017_grid",{root:!0}),t("load")}},load:function(e){var t=e.dispatch;t("downloadAndCreateLayers","https://ees-server.now.sh/populations/link_entry_frames_grouped.json")},downloadAndCreateLayers:function(e,t){var n=e.dispatch,a=e.commit,o=e.getters,i=e.rootGetters,r=i.mapInstance;a(f["M"],null,{root:!0}),window.populationGeojson=[],fetch(t).then((function(e){return e.json()})).then((function(e){window.populationGeojson=e;var t="output-layer",s="output-source";a(f["C"],{map:r,popSlice:{sourceName:s,geojson:window.populationGeojson[0]}}),a(f["B"],{map:r,beforeLayer:i.fireBeforeLayer,popSlice:{sourceName:s,layerName:t}});var l=(e.length-1)*o.stepSeconds/60;n("filter",parseInt(l/i["fire/stepMinutes"]),{root:!0}),n("filterSeconds",e.length-1,{root:!0}),a(f["e"],null,{root:!0})}))},filterSeconds:{root:!0,handler:function(e,t){var n=e.commit,a=e.rootGetters;n("SET_VISIBLE_STEP",t);var o=a.mapInstance,i=o.getSource("output-source");"undefined"!==typeof i&&i.setData(window.populationGeojson[t])}},setOpacity:function(e,t){var n=e.rootGetters,a=e.commit,o=n.mapInstance,i="output-layer";a(f["A"],t),o.setPaintProperty(i,"circle-opacity",t)},reload:{root:!0,handler:function(e){var t,n=e.rootGetters,a=e.commit,o=n.mapInstance;t="output-layer",o.removeLayer(t),z.loadedLayers=[];var i="output-source";a(f["B"],{map:o,popSlice:{sourceName:i,layerName:t}})}}},Q={namespaced:Y,state:z,getters:K,mutations:X,actions:Z};u["default"].use(p["a"]);t["a"]=new p["a"].Store({modules:{config:b,map:L,fire:M,smoke:R,population:B,simulation:J,output:Q}})},4658:function(e,t,n){},"50f0":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("14c6"),n("08c1"),n("4842"),n("d9fc");var a=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view",{staticClass:"router-view"})],1)},i=[],r=(n("5c0b"),n("2877")),s={},l=Object(r["a"])(s,o,i,!1,null,null,null),c=l.exports,u=n("8c4f"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{"!keydown":function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.toggleSettingsVis()}}},[n("maplayer"),n("popLegend"),n("slider"),n("spinner"),n("population"),n("setup"),n("buttons"),n("savesettings")],1)},d=[],f=n("cebc"),m=n("a0be"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.visibleStep||0===e.visibleStep?n("div",{staticClass:"time-slider-overlay"},[n("div",{staticClass:"time-slider-overlay-inner"},[n("vue-slider",e._b({ref:"fireslider",attrs:{marks:e.hasLabel,tooltip:"always","tooltip-formatter":e.stepToTime,"use-keyboard":!0},scopedSlots:e._u([{key:"label",fn:function(t){var a=t.active,o=t.value;return[n("div",{class:["vue-slider-mark-label","custom-label",{active:a}]},[e._v("\n          "+e._s(e.stepToTime(o))+"\n        ")])]}}],null,!1,3544431226),model:{value:e.timeStep,callback:function(t){e.timeStep=t},expression:"timeStep"}},"vue-slider",e.sliderConfig,!1))],1)]):e._e()},y=[],v=(n("f576"),n("6b54"),n("4971")),b=n.n(v),g=(n("24df"),n("2f62")),S={name:"mapSlider",components:{VueSlider:b.a},props:{},data:function(){var e=[];return e["sm"]=36,e["md"]=24,e["lg"]=6,{labelStep:e}},computed:Object(f["a"])({},Object(g["d"])({fireStepMinutes:function(e){return e.fire.stepMinutes},visibleStep:function(e){return e.fire.visibleStep},fireSliderTicks:function(e){return e.fire.fireSliderTicks}}),{sliderConfig:function(){return{width:"98%",value:this.visibleStep?this.visibleStep:0,min:0,max:this.maxSteps}},timeStep:{get:function(){return this.visibleStep},set:function(e){this.$store.dispatch("filter",e)}},maxSteps:function(){return 1440/this.fireStepMinutes}}),methods:{hasLabel:function(e){var t=this.labelStep[this.$mq],n=e<this.maxSteps-t+1;return e%t===0&&n||e===this.maxSteps-1},stepToTime:function(e){return Math.floor(10*e/60).toString()+":"+(10*e%60).toString().padStart(2,"0")}}},O=S,_=(n("24f5"),Object(r["a"])(O,h,y,!1,null,null,null)),L=_.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return null!==e.popSelected?n("div",{staticClass:"legend-overlay"},[n("div",{staticClass:"legend-overlay-inner"},[n("table",{attrs:{id:"pop-legend",cellspacing:"3px"}},e._l(e.currActivities,(function(t,a,o){return n("tr",{key:a},[n("td",[n("verte",{staticClass:"p-1",attrs:{menuPosition:"top",picker:"square",model:"hex",value:t},on:{input:function(t){return e.changeColor(o,t)}}})],1),n("td",{staticClass:"p-2"},[e._v(e._s(a))])])})),0)])]):e._e()},k=[],I=n("36fc"),w=(n("bbb4"),{name:"mapPopLegend",props:{},data:function(){return{}},components:{Verte:I["a"]},computed:Object(f["a"])({},Object(g["c"])({popSelected:"population/selected",currActivities:"population/currActivities"})),methods:{changeColor:function(e,t){this.$store.dispatch("population/changeActivityColor",{id:e,color:t})}}}),x=w,A=(n("3126"),Object(r["a"])(x,T,k,!1,null,null,null)),M=A.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-settings-container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpen,expression:"isOpen"}],staticClass:"map-overlay"},[n("div",{staticClass:"map-population-panel"},[n("label",{attrs:{for:"map-population"}},[e._v("Population inside square:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.squarePopulation,expression:"squarePopulation"}],attrs:{id:"map-population",type:"text"},domProps:{value:e.squarePopulation},on:{input:function(t){t.target.composing||(e.squarePopulation=t.target.value)}}}),n("button",{staticClass:"icon",attrs:{type:"button"},on:{click:function(t){return e.toggle()}}},[e._v("Save")])])]),n("div",{attrs:{id:"map-link-panel"}})])},C=[],E=(n("c5f6"),{name:"mapSquarePopulation",props:{squarePopulation:{default:0,type:Number}},computed:{isOpen:{get:function(){return this.$store.state.map.squarePopulationIsOpen},set:function(e){this.$store.commit("setSquarePopulationIsOpen",e)}}},methods:{toggle:function(){this.$store.commit("setSquarePopulationIsOpen",!this.$store.state.map.squarePopulationIsOpen)}}}),N=E,P=(n("9d64"),Object(r["a"])(N,j,C,!1,null,null,null)),R=P.exports,D=n("6f8e"),F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-container",{directives:[{name:"show",rawName:"v-show",value:null!=this.$store.state.map.mapInstance&&(null!=this.$store.state.config.data||null!=this.error)&&this.$store.state.map.mapSettingsIsOpen,expression:"\n    this.$store.state.map.mapInstance != null &&\n      (this.$store.state.config.data != null || this.error != null) &&\n      this.$store.state.map.mapSettingsIsOpen\n  "}],staticClass:"p-0 h-100 mapboxgl-ctrl-top-left map-sidebar-container",attrs:{fluid:""}},[n("b-row",{staticClass:"h-100",attrs:{"no-gutters":""}},[n("b-col",{staticClass:"h-100 m-0 pt-2 mapboxgl-ctrl map-sidebar-col",attrs:{sm:"5"}},[n("div",{attrs:{id:"h-100 nav"}},[n("h5",[e._v("Emergency Evacuation Simulator")]),n("router-link",{attrs:{to:"/"}},[e._v("Home")]),e._v(" |\n        "),n("router-link",{attrs:{to:"/about"}},[e._v("About")])],1),n("b-collapse",{staticClass:"h-100",attrs:{visible:"",id:"collapse-side-panel"}},[n("div",{staticClass:"h-100 map-accordion-container"},[null!=this.error?n("b-alert",{attrs:{show:"",variant:"danger"},domProps:{innerHTML:e._s(this.error)}}):e._e(),n("b-card",{staticClass:"mb-1 p-0",attrs:{header:"Scenario"}},[n("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"4",label:"Region","label-for":"map-region"}},[n("b-form-select",{attrs:{id:"map-region"},model:{value:e.selectedRegion,callback:function(t){e.selectedRegion=t},expression:"selectedRegion"}},[n("option",{attrs:{value:"any-placeholder"}},[e._v("(any)")]),e._l(e.regions,(function(t,a){return n("option",{key:a,attrs:{disabled:e.selectedRegion==a},domProps:{value:a}},[e._v(e._s(t.name))])}))],2)],1),n("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"4",label:"Population","label-for":"map-population",description:e.popDesc}},[n("b-form-select",{attrs:{id:"map-population"},model:{value:e.selectedPopulation,callback:function(t){e.selectedPopulation=t},expression:"selectedPopulation"}},[n("option",{attrs:{value:"no-population",disabled:"no-population"==e.selectedPopulation}},[e._v("None")]),e._l(e.popInSelectedRegion,(function(t,a){return n("option",{key:a,attrs:{disabled:e.selectedPopulation==a},domProps:{value:a}},[e._v(e._s(t.display_name))])}))],2)],1)],1),n("b-card",{staticClass:"mb-1",scopedSlots:e._u([{key:"header",fn:function(){return[n("h6",{staticClass:"mb-0"},[e._v("\n                Emergency Incident\n                "),n("span",{staticClass:"helper-icons"},[n("FontAwesomeIcon",{directives:[{name:"b-popover",rawName:"v-b-popover.hover",value:e.helperOptions[0].text,expression:"helperOptions[0].text",modifiers:{hover:!0}}],attrs:{icon:"info-circle"}})],1)])]},proxy:!0}])},[n("b-collapse",{attrs:{visible:"",id:"collapse-incident"}},[n("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"4",label:"Fire","label-for":"map-fire",description:e.eventDesc}},[n("b-form-select",{attrs:{id:"map-fire"},model:{value:e.selectedFire,callback:function(t){e.selectedFire=t},expression:"selectedFire"}},[n("option",{attrs:{value:"no-fire",disabled:"no-fire"==e.selectedFire}},[e._v("None")]),e._l(e.firesInSelectedRegion,(function(t,a){return n("option",{key:a,attrs:{disabled:e.selectedFire==a},domProps:{value:a}},[e._v(e._s(t.display_name))])}))],2)],1),n("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"4",label:"Display Embers","label-for":"map-embers"}},[n("b-form-checkbox",{staticClass:"ml-2 form-check-input",attrs:{id:"map-embers",disabled:"no-fire"==e.selectedFire},model:{value:e.showSmoke,callback:function(t){e.showSmoke=t},expression:"showSmoke"}})],1)],1)],1),n("MapTrafficBehaviourCard",{attrs:{helpText:e.helperOptions[3].text,trafficSpeed:100}}),n("b-card",{staticClass:"mb-1",attrs:{header:"UI Settings"}},[n("b-collapse",{attrs:{visible:"",id:"collapse-map-style"}},[n("b-form",[n("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"8",label:"Map Style","label-for":"map-style"}},[n("b-form-select",{attrs:{id:"map-style"},model:{value:e.mapboxStyle,callback:function(t){e.mapboxStyle=t},expression:"mapboxStyle"}},e._l(e.styles,(function(t){return n("option",{key:t.id,attrs:{disabled:e.mapboxStyle.id==t.id},domProps:{value:t.id}},[e._v(e._s(t.name))])})),0)],1),n("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"8",label:"Fire Opacity","label-for":"fire_opacity"}},[n("b-form-input",{attrs:{id:"fire_opacity",type:"number",value:"0.7",step:"0.1",min:"0",max:"1",disabled:null==this.$store.state.fire.selectedFire},model:{value:e.fireOpacity,callback:function(t){e.fireOpacity=t},expression:"fireOpacity"}})],1),n("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"8",label:"Embers Opacity","label-for":"smoke_opacity"}},[n("b-form-input",{attrs:{id:"smoke_opacity",type:"number",value:"0.5",step:"0.1",min:"0",max:"1",disabled:null==this.$store.state.fire.selectedFire},model:{value:e.smokeOpacity,callback:function(t){e.smokeOpacity=t},expression:"smokeOpacity"}})],1),n("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-lg":"8",label:"Population Opacity","label-for":"population_opacity"}},[n("b-form-input",{attrs:{id:"population_opacity",type:"number",value:"0.5",step:"0.1",min:"0",max:"1"},model:{value:e.popOpacity,callback:function(t){e.popOpacity=t},expression:"popOpacity"}})],1)],1)],1)],1),n("br"),n("br"),n("br")],1)])],1)],1)],1)},$=[],G=(n("28a5"),n("4917"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-link-panel"},[n("b-form-group",{attrs:{label:"MATSim Link ID:","label-for":"map-link"}},[n("b-form-input",{attrs:{id:"map-link",type:"text",placeholder:"Please select a MATSim Network Link from the map",readonly:""},model:{value:e.linkId,callback:function(t){e.linkId=t},expression:"linkId"}})],1),n("b-form-group",{attrs:{label:"Disruption Start Time:","label-for":"map-link-start"}},[n("b-form-input",{attrs:{id:"map-link-start",type:"text"},model:{value:e.linkStart,callback:function(t){e.linkStart=t},expression:"linkStart"}})],1),n("button",{staticClass:"icon",attrs:{type:"button"},on:{click:function(t){return e.toggle()}}},[e._v("Save")])],1)}),H=[],B={name:"mapAffectedLink",props:{linkId:{default:"",type:String},linkStart:{default:"00:00",type:String}},computed:{isOpen:{get:function(){return this.$store.state.map.affectedLinkIsOpen},set:function(e){this.$store.commit("setAffectedLinkIsOpen",e)}}},methods:{toggle:function(){this.$store.commit("setAffectedLinkIsOpen",!this.$store.state.map.affectedLinkIsOpen)}}},q=B,U=(n("11d8"),Object(r["a"])(q,G,H,!1,null,null,null)),W=U.exports,V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-card",{staticClass:"mb-1",attrs:{header:"Traffic Behaviour Setup"}},[n("b-collapse",{attrs:{visible:"",id:"collapse-traffic"}},[n("label",[e._v("\n      Maximum speed on roads (as % of speed limits)\n      "),n("span",{staticClass:"helper-icons"},[n("FontAwesomeIcon",{directives:[{name:"b-popover",rawName:"v-b-popover.hover",value:e.helpText,expression:"helpText",modifiers:{hover:!0}}],attrs:{icon:"info-circle"}})],1)]),n("div",{staticClass:"traffic-slider"},[n("vue-slider",e._b({ref:"trafficslider",attrs:{interval:10,tooltip:"always","tooltip-formatter":e.valueToPercent,marks:e.valueToMark,"drag-on-click":!0},model:{value:e.trafficSpeed,callback:function(t){e.trafficSpeed=t},expression:"trafficSpeed"}},"vue-slider",e.sliderConfig,!1))],1)])],1)},J=[],Y=n("ecee"),z=n("c074"),K=n("ad3d");Y["c"].add(z["b"]);var X={name:"mapTrafficCard",components:{VueSlider:b.a,FontAwesomeIcon:K["a"]},props:["trafficSpeed","helpText"],data:function(){var e=this;return{sliderConfig:{min:0,max:100,dotStyle:{display:"none"}},valueToPercent:function(e){return"".concat(e,"%")},valueToMark:function(t){return{label:t%100===0?e.valueToPercent(t):""}}}}},Z=X,Q=(n("793f"),Object(r["a"])(Z,V,J,!1,null,null,null)),ee=Q.exports;Y["c"].add(z["c"],z["b"],z["f"]),a["default"].config.productionTip=!1;var te={name:"mapSetup",props:{},data:function(){return{isHidden:!1,styles:this.$store.state.config.styles,populations:this.$store.state.config.populations,modalShow:!1,global:[{text:"startHHMM",value:"00:00"}],phoenix:[{text:"ignitionHHMM",value:"00:00"},{text:"fireGeoJson",value:"scenarios/surf-coast-shire/test-files/scenario_fire.json"},{text:"smokeGeoJson",value:""}],matsim:[{text:"outputDir",value:"test/output/io/github/agentsoz/ees//TypicalSummerWeekday50kTest/testTypicalSummerWeekday50k/matsim"},{text:"configXml",value:"scenarios/surf-coast-shire/test-files/scenario_matsim_main.xml"},{text:"maxDistanceForFireVisual",value:"1000"},{text:"maxDistanceForSmokeVisual",value:"5000"},{text:"fireAvoidanceBufferForVehicles",value:"5000"},{text:"fireAvoidanceBufferForEmergencyVehicles",value:"1000"},{text:"congestionEvaluationInterval",value:"180"},{text:"congestionToleranceThreshold",value:"0.33"},{text:"congestionReactionProbability",value:"0.0"}],trafficBehaviour:[{text:"proportion",value:"0.0"},{text:"radiusInMtrs",value:"0"}],dest_selected:null,dest_options:[{value:null,text:"Please select an option"}],helperOptions:[{value:0,text:"If the location chosen has fire models, choose which one to use. Select whether to show visually on map.\nEvacuation can proceed without fire model, in which case No incident should be selected. If a fire model is selected, key attributes are displayed."},{value:1,text:"Evac start is the time at which evacuation starts (announcement is made).\nIf there is a fire model, this should be some time after fire ignition attribute of chosen fire.\nEvac peak is the length of time after the start, at which the largest number of people are starting to leave.\nEvacuations are dispersed around the peak point."},{value:2,text:"Potential destinations are indicated in location file. These provide direction of evacuation. If multiple destinations are given, evacuation is split between these (currently an equal split - future work will allow user specification).\nThe safe line is a line beyond which evacuees can be considered out of danger. Safe lines should be sufficiently long to cut all possible roads that could be used to a given destination. Only one safe line is allowed per destination. To draw line, click start point, release, click end point."},{value:3,text:"The simulator will modify speeds based on congestion. However in a bushfire additional factors (e.g. smoke) may affect possible speed. This allows that to be specified as a % of the normal speed. The setting will affect all roads in the network, not only those near the fire."}]}},computed:Object(f["a"])({},Object(g["d"])({populationSquares:function(e){return e.map.populationSquares},selectedMATSimLink:function(e){return e.map.selectedMATSimLink},visibleStep:function(e){return e.fire.visibleStep},error:function(e){return e.config.error}}),Object(g["c"])(["mapInstance","regions","selectedStyle","selectedRegion","popInSelectedRegion"]),Object(g["c"])({popDesc:"population/description",eventDesc:"fire/description"}),{firesInSelectedRegion:function(){return this.$store.getters.firesInSelectedRegion?this.$store.getters.firesInSelectedRegion:[]},mapboxStyle:{get:function(){return this.$store.state.map.mapboxStyle},set:function(e){this.changeMapboxStyle(e)}},selectedRegion:{get:function(){return this.$store.state.map.selectedRegion?this.$store.state.map.selectedRegion:"no-region"},set:function(e){this.selectRegion(e)}},selectedPopulation:{get:function(){return null==this.$store.getters["population/selected"]?"no-population":this.$store.state.population.selected},set:function(e){this["population/select"](e)}},selectedFire:{get:function(){return null==this.$store.getters["fire/selectedFire"]?"no-fire":this.$store.state.fire.selectedFire},set:function(e){this["fire/select"](e)}},selectedIncident:{get:function(){return["fire"]}},showSmoke:{get:function(){return this.$store.state.smoke.smokeVisible},set:function(e){this["smoke/toggle"](e)}},fireOpacity:{get:function(){return this.$store.state.fire.opacity},set:function(e){var t=/^[-+]?[0-9]+\.[0-9]+$/;e.match(t)&&this.$store.dispatch("fire/setOpacity",parseFloat(e))}},smokeOpacity:{get:function(){return this.$store.state.smoke.opacity},set:function(e){var t=/^[-+]?[0-9]+\.[0-9]+$/;e.match(t)&&this.$store.dispatch("smoke/setOpacity",parseFloat(e))}},popOpacity:{get:function(){return this.$store.state.population.opacity},set:function(e){var t=/^[-+]?[0-9]+\.[0-9]+$/;e.match(t)&&this.$store.dispatch("population/setOpacity",parseFloat(e))}}}),components:{mapAffectedLink:W,MapTrafficBehaviourCard:ee,FontAwesomeIcon:K["a"]},methods:Object(f["a"])({},Object(g["b"])(["selectRegion","changeMapboxStyle","fire/select","smoke/toggle","population/select"]),{setRegion:function(e){this.selectRegion(e.target.dataset.region)},drawRectangle:function(){this.$store.commit("drawPopulationSquare")},toggle:function(){this.isHidden=!this.isHidden},changeTime:function(e){if(4==e.length){if(":"==e.charAt(2)){var t=new Array;t=e.split(":"),t[0]<=12&&t[1]<=59&&(this.evac_time=t[0]+":"+t[1])}}else this.evac_time="0:00"}})},ne=te,ae=(n("a69a"),Object(r["a"])(ne,F,$,!1,null,null,null)),oe=ae.exports,ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"map-settings-container",on:{"!keydown":function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.toggle()}}},[n("div",{staticClass:"map-settings-hamburger mapboxgl-ctrl-top-left"},[n("button",{staticClass:"pt-2 pb-1 px-3 mapboxgl-ctrl mapboxgl-ctrl-group",attrs:{type:"button"},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.toggle()},click:function(t){return e.toggle()}}},[n("FontAwesomeIcon",{attrs:{icon:"bars",size:"2x"}})],1)]),n("div",{staticClass:"map-settings-button-container mapboxgl-ctrl-top-right",attrs:{"z-index":"10000"}},[n("div",{staticClass:"mapboxgl-ctrl mapboxgl-ctrl-group"},[n("button",{staticClass:"icon polygon",attrs:{type:"button"},on:{click:function(t){return e.drawRectangle()}}})]),n("div",{staticClass:"mapboxgl-ctrl mapboxgl-ctrl-group"},[n("button",{class:{"font-weight-bold":e.renderFireIn3D},attrs:{type:"button"},on:{click:function(t){return e.toggleFireIn3D()}}},[e._v("\n        3D\n      ")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:""!=this.$store.state.map.selectedMATSimLink||this.showDisruptionWindow,expression:"\n        this.$store.state.map.selectedMATSimLink != '' ||\n          this.showDisruptionWindow\n      "}],staticClass:"mapboxgl-ctrl mapboxgl-ctrl-group"},[n("button",{staticClass:"icon bug",style:this.showDisruptionWindow?"background-color: lightskyblue;":"",attrs:{type:"button"},on:{click:function(t){e.showDisruptionWindow=!e.showDisruptionWindow}}})])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showDisruptionWindow,expression:"showDisruptionWindow"}],staticClass:"map-overlay"},[e.isLinkDisrupted()?n("div",{staticClass:"save-simulation-panel"},[n("h3",[e._v("Disruption")]),n("button",{staticClass:"btn btn-danger",staticStyle:{width:"100% !important"},on:{click:function(t){return e.deleteDisruption()}}},[e._v("\n        Delete\n      ")])]):n("div",{staticClass:"save-simulation-panel"},[n("h3",[e._v("Disruption")]),n("label",{staticClass:"form-label",attrs:{id:"status1"}},[e._v("Description")]),n("input",{ref:"description",attrs:{id:"simulation-name",placeholder:"",type:"text"}}),n("div",{staticClass:"container"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col"}),n("div",{staticClass:"col"},[e._v("\n            Start Time\n            "),n("input",{ref:"startTime",staticClass:"form-control",attrs:{type:"time",value:"00:00:00",id:"example-time-input"}})]),n("div",{staticClass:"col"},[e._v("\n            End Time\n            "),n("input",{ref:"endTime",staticClass:"form-control",attrs:{type:"time",value:"00:00:00",id:"example-time-input"}})]),n("div",{staticClass:"col-4"},[e._v("\n            Speed\n            "),n("div",{staticClass:"input-group"},[n("input",{ref:"speed",staticClass:"form-control",staticStyle:{"text-align":"right"},attrs:{type:"number",placeholder:"Speed","aria-label":"Recipient's username","aria-describedby":"basic-addon2"}}),n("div",{staticClass:"input-group-append"},[n("button",{class:e.absoluteSpeed?"btn btn-primary":"btn btn-secondary",attrs:{type:"button"},on:{click:function(t){e.absoluteSpeed=!0}}},[e._v("\n                  KM/H\n                ")]),n("button",{class:e.absoluteSpeed?"btn btn-secondary":"btn btn-primary",attrs:{type:"button"},on:{click:function(t){e.absoluteSpeed=!1}}},[e._v("\n                  %\n                ")])])])]),n("div",{staticClass:"col"})])]),n("label",{staticClass:"form-label",attrs:{id:"status1"}},[e._v("Affected Links")]),n("input",{staticStyle:{"margin-bottom":"10px"},attrs:{id:"simulation-name",type:"text",disabled:""},domProps:{value:this.$store.state.map.selectedMATSimLink}}),""!=this.$store.state.map.selectedMATSimLink?n("button",{staticClass:"btn btn-success",staticStyle:{width:"100% !important"},on:{click:function(t){return e.saveDisruption()}}},[e._v("\n        Save\n      ")]):n("button",{staticClass:"btn btn-success",staticStyle:{width:"100% !important"},attrs:{disabled:""},on:{click:function(t){return e.saveDisruption()}}},[e._v("\n        Save\n      ")])])])])},re=[],se=(n("ac6a"),n("9fb0"));Y["c"].add(z["a"]);var le={name:"mapButtons",props:{},components:{FontAwesomeIcon:K["a"]},data:function(){return{absoluteSpeed:!0,showDisruptionWindow:!1,styles:this.$store.state.config.styles,regions:this.$store.state.config.regions}},computed:{renderFireIn3D:{get:function(){return this.$store.state.fire.fire3DFlameHeight}}},methods:Object(f["a"])({},Object(g["b"])({toggleFireIn3D:"fire/toggleFireIn3D",toggle:"toggleSettingsVis"}),{drawRectangle:function(){this.$store.commit("drawPopulationSquare")},saveDisruption:function(){var e=this.$store,t=e.state.map.mapInstance,n={affectedLinks:e.state.map.selectedMATSimLink,start:this.$refs.startTime.value,end:this.$refs.endTime.value,description:this.$refs.description.value,speed:this.$refs.speed.value,absoluteSpeed:this.absoluteSpeed},a=["in","ID"];e.commit(se["k"],n),e.state.map.disruptions.forEach((function(e){e.affectedLinks.forEach((function(e){a.push(e)}))})),t.setFilter(e.state.map.disruptionMATSimLayer,a),this.showDisruptionWindow=!1,e.state.map.selectedMATSimLink=""},isLinkDisrupted:function(){var e=this.$store.state.map.selectedMATSimLink,t=this.$store.state.map.disruptions,n=!1;return t.forEach((function(t){t.affectedLinks.forEach((function(t){t==e&&(n=!0)}))})),n},deleteDisruption:function(){var e=this.$store.state.map.selectedMATSimLink,t=this.$store.state.map.disruptions,n=this.$store,a=["in","ID"];this.showDisruptionWindow=!1,t.forEach((function(n,a){n.affectedLinks.forEach((function(n){n==e&&delete t[a]}))})),n.state.map.mapInstance.setFilter(n.state.map.selectedDisruptionMATSimLayer,a),t.forEach((function(e){e.affectedLinks.forEach((function(e){a.push(e)}))})),n.state.map.mapInstance.setFilter(n.state.map.disruptionMATSimLayer,a),n.commit(se["o"],null)}})},ce=le,ue=(n("a003"),Object(r["a"])(ce,ie,re,!1,null,null,null)),pe=ue.exports,de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"save-map-settings-container"},[n("b-button",{attrs:{variant:"outline-primary",id:"save-map-settings-toggle"},on:{click:e.SaveSimulationToggle}},[e._v("Save")]),n("b-button",{attrs:{variant:"outline-primary",id:"create-simulation"}},[e._v("Create")]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.simSettingsIsOpen,expression:"simSettingsIsOpen"}],staticClass:"map-overlay"},[n("div",{staticClass:"save-simulation-panel"},[n("label",{attrs:{for:"simulation-name"}},[e._v("Simulation Name:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.simulationName,expression:"simulationName"}],attrs:{id:"simulation-name",type:"text"},domProps:{value:e.simulationName},on:{input:function(t){t.target.composing||(e.simulationName=t.target.value)}}}),n("b-button",{attrs:{variant:"outline-primary",id:"save-map-settings"},on:{click:e.SaveSimulationConfig}},[e._v("Save")]),n("b-button",{attrs:{variant:"outline-primary",id:"cancel-map-settings"},on:{click:e.SaveSimulationToggle}},[e._v("Cancel")])],1)])],1)},fe=[],me={name:"saveSettings",props:{toggle:{default:!1,type:Boolean}},data:function(){return{}},computed:Object(f["a"])({},Object(g["d"])({simSettingsIsOpen:function(e){return e.simulation.simSettingsIsOpen}}),Object(g["c"])(["selectedRegion","selectedFire"]),{simulationName:{get:function(){return this.$store.state.simulation.simulationName},set:function(e){this.$store.commit("setSimulationName",e)}}}),methods:{SaveSimulationToggle:function(){this.$store.commit(se["r"],!this.saveSimIsOpen)},SaveSimulationConfig:function(){var e={simulationName:this.simulationName,config:{ees:[{global:[{randomSeed:"1234",crs:"EPSG:28355",startHHMM:"00:00"}],bdi:[{jPlanSelectionPolicy:"FIRST",jAgents:"",jLogLevel:"WARN",jLogFile:"test/output/io/github/agentsoz/ees/TypicalSummerWeekday50kTest/testTypicalSummerWeekday50k/jill.log",jOutFile:"test/output/io/github/agentsoz/ees//TypicalSummerWeekday50kTest/testTypicalSummerWeekday50k/jill.out"}],matsim:[{outputDir:"test/output/io/github/agentsoz/ees//TypicalSummerWeekday50kTest/testTypicalSummerWeekday50k/matsim",configXml:"scenarios/surf-coast-shire/typical-summer-weekday-50k/scenario_matsim_main.xml",maxDistanceForFireVisual:"1000",maxDistanceForSmokeVisual:"5000",fireAvoidanceBufferForVehicles:"5000",fireAvoidanceBufferForEmergencyVehicles:"1000",congestionEvaluationInterval:"180",congestionToleranceThreshold:"0.33",congestionReactionProbability:"0.0"}],phoenix:[{ignitionHHMM:"00:00",fireGeoJson:this.selectedFire.geojson,smokeGeoJson:""}],disruption:[{fileJson:"scenarios/surf-coast-shire/typical-summer-weekday-50k/scenario_disruptions.json"}],messaging:[{fileJson:"scenarios/surf-coast-shire/typical-summer-weekday-50k/scenario_messages.json"}]}],scenario_main:[{matsimfile:"scenarios/surf-coast-shire/typical-summer-weekday-50k/scenario_matsim_main.xml",firefile:[{name:"",coordinates:"",format:""}],geographyfile:[{geo_name:"scenarios/surf-coast-shire/typical-summer-weekday-50k/scenario_geography.xml"}],trafficBehaviour:[{proportion:"0.0",radiusInMtrs:"0"}],evacuationTiming:[{start:"00:00",peak:"00"}],bdiagents:"bdiagents"}]}};this.$store.commit(se["p"],e,this.simulationName),this.SaveSimulationToggle()}}},he=me,ye=(n("940b"),Object(r["a"])(he,de,fe,!1,null,null,null)),ve=ye.exports,be={name:"home",components:{maplayer:m["a"],slider:L,popLegend:M,spinner:D["a"],population:R,setup:oe,buttons:pe,savesettings:ve},methods:Object(f["a"])({},Object(g["b"])(["toggleSettingsVis"]))},ge=be,Se=Object(r["a"])(ge,p,d,!1,null,null,null),Oe=Se.exports;a["default"].use(u["a"]);var _e=new u["a"]({routes:[{path:"/",name:"home",component:Oe},{path:"/output",name:"output",component:function(){return n.e("output").then(n.bind(null,"2ef2"))}},{path:"/about",name:"about",component:function(){return n.e("about").then(n.bind(null,"f820"))}}]}),Le=n("4360"),Te=n("5f5b"),ke=(n("f9e3"),n("2dd8"),n("660e"));a["default"].use(Te["a"]),a["default"].use(ke["a"]),a["default"].config.productionTip=!1,new a["default"]({el:"#app",router:_e,store:Le["a"],render:function(e){return e(c)},mounted:function(){this.$store.dispatch("getConfig","https://ees-server.now.sh/config")}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var a=n("e332"),o=n.n(a);o.a},"6c7f":function(e,t,n){},"6f8e":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return 0!==e.isLoading?n("div",{staticClass:"load-spinner-overlay"},[e._m(0)]):e._e()},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"load-spinner-overlay-inner"},[n("span",{staticClass:"loading"})])}],i=n("cebc"),r=n("2f62"),s={name:"mapSpinner",props:{},computed:Object(i["a"])({},Object(r["d"])({isLoading:function(e){return e.map.isLoading}}))},l=s,c=(n("1570"),n("2877")),u=Object(c["a"])(l,a,o,!1,null,null,null);t["a"]=u.exports},"793f":function(e,t,n){"use strict";var a=n("6c7f"),o=n.n(a);o.a},"826e":function(e,t,n){},"8eaf":function(e,t,n){},"940b":function(e,t,n){"use strict";var a=n("0dc4"),o=n.n(a);o.a},"98bd":function(e,t,n){},"9c29":function(e,t,n){},"9d64":function(e,t,n){"use strict";var a=n("4658"),o=n.n(a);o.a},"9fb0":function(e,t,n){"use strict";n.d(t,"M",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"L",(function(){return i})),n.d(t,"J",(function(){return r})),n.d(t,"K",(function(){return s})),n.d(t,"I",(function(){return l})),n.d(t,"H",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"j",(function(){return p})),n.d(t,"m",(function(){return d})),n.d(t,"n",(function(){return f})),n.d(t,"l",(function(){return m})),n.d(t,"s",(function(){return h})),n.d(t,"u",(function(){return y})),n.d(t,"v",(function(){return v})),n.d(t,"t",(function(){return b})),n.d(t,"k",(function(){return g})),n.d(t,"q",(function(){return S})),n.d(t,"o",(function(){return O})),n.d(t,"p",(function(){return _})),n.d(t,"r",(function(){return L})),n.d(t,"F",(function(){return T})),n.d(t,"a",(function(){return k})),n.d(t,"G",(function(){return I})),n.d(t,"b",(function(){return w})),n.d(t,"A",(function(){return x})),n.d(t,"D",(function(){return A})),n.d(t,"E",(function(){return M})),n.d(t,"C",(function(){return j})),n.d(t,"B",(function(){return C})),n.d(t,"x",(function(){return E})),n.d(t,"w",(function(){return N})),n.d(t,"y",(function(){return P})),n.d(t,"z",(function(){return R})),n.d(t,"f",(function(){return D})),n.d(t,"h",(function(){return F})),n.d(t,"g",(function(){return $})),n.d(t,"i",(function(){return G})),n.d(t,"d",(function(){return H})),n.d(t,"N",(function(){return B}));var a="START_LOADING",o="DONE_LOADING",i="SET_MAP_INSTANCE",r="SET_DRAW_INSTANCE",s="SET_MAPBOX_STYLE",l="SETTINGS_VISIBILITY",c="SELECT_REGION",u="CLEAR_REGION",p="FLY_TO",d="MATSIM_ADD_PLACEHOLDER_LAYERS",f="MATSIM_ADD_SOURCE",m="MATSIM_ADD_LAYER",h="MATSIM_SET_BASE_LAYER",y="MATSIM_SET_HIGHLIGHT_LAYER",v="MATSIM_SET_SELECTED_DISRUPTION_LAYER",b="MATSIM_SET_DISRUPTION_LAYER",g="MATSIMATSIM_ADD_DISRUPTION",S="MATSIM_SELECT_LINK",O="MATSIM_DESELECT_LINK",_="MATSIM_SAVE_CONFIG",L="MATSIM_SETTINGS_VIS",T="SELECT_FIRE",k="CLEAR_FIRE",I="SELECT_POPULATION",w="CLEAR_POPULATION",x="POPULATION_SET_OPACITY",A="POP_SET_ACTIVITIES",M="POP_SET_ACTIVITY_COLOR",j="POP_ADD_SOURCE",C="POP_ADD_LAYER",E="PHOENIX_ADD_SOURCE",N="PHOENIX_ADD_LAYER",P="PHOENIX_SET_OPACITY",R="PHOENIX_TIME_STEP",D="DRAW_SMOKE",F="EMBER_ADD_SOURCE",$="EMBER_ADD_LAYER",G="EMBER_SET_OPACITY",H="CLEAR_SMOKE",B="TOGGLE_3D"},a003:function(e,t,n){"use strict";var a=n("8eaf"),o=n.n(a);o.a},a0be:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("mapbox",{attrs:{"access-token":e.mapboxAccessToken,"map-options":e.mapOpts,"geolocate-control":{show:!0,position:"top-right"},"scale-control":{show:!0,position:"bottom-left"}},on:{"map-load":e.storeMapInstance}})},o=[],i=(n("6762"),n("2fdb"),n("ac6a"),n("cebc")),r=n("873e"),s=n("e192"),l=n.n(s),c=n("6ee6"),u=n.n(c),p=n("b106"),d=n.n(p),f=n("4360"),m=n("9fb0"),h=n("2f62"),y={name:"maplayer",data:function(){return{disruptionSelected:!1}},computed:Object(i["a"])({},Object(h["d"])({mapboxAccessToken:function(e){return e.config.mapboxAccessToken},mapboxStyle:function(e){return e.map.mapboxStyle},mapCenter:function(e){return e.map.mapCenter},mapInstance:function(e){return e.map.mapInstance},baseMATSimLayer:function(e){return e.map.baseMATSimLayer},highlightMATSimLayer:function(e){return e.map.highlightMATSimLayer},disruptionMATSimLayer:function(e){return e.map.disruptionMATSimLayer},selectedDisruptionMATSimLayer:function(e){return e.map.selectedDisruptionMATSimLayer}}),{mapOpts:function(){var e={style:"mapbox://styles/mapbox/"+this.mapboxStyle+"-v9",center:this.mapCenter,minZoom:0,zoom:6,maxZoom:18};return e}}),components:{mapbox:r["a"]},methods:{storeMapInstance:function(e){e.on("click",this.mapOnClick),e.on("draw.create",this.squareCreated),e.on("style.load",this.loadLayersOnStyleChange);var t=new u.a({displayControlsDefault:!1,modes:Object.assign({draw_rectangle:d.a},u.a.modes)});e.addControl(t),f["a"].commit(m["L"],e),f["a"].commit(m["J"],t),this.loadLayersOnStyleChange()},loadLayersOnStyleChange:function(){f["a"].commit(m["m"]),f["a"].dispatch("loadGlobal")},squareCreated:function(e){var t=e.features[0];f["a"].commit("addPopulationSquare",t)},mapOnClick:function(e){var t,n=this,a=""==f["a"].state.map.selectedMATSimLink?[]:f["a"].state.map.selectedMATSimLink,o=[[e.point.x-5,e.point.y-5],[e.point.x+5,e.point.y+5]],i=this.mapInstance.queryRenderedFeatures(o,{layers:[this.baseMATSimLayer]});if("undefined"!=typeof i&&0!==i.length){var r=i[0].geometry.coordinates.slice()[0][0],s=i[0].properties.ID,c=a.filter((function(e){return e!==s}));a.length!=c.length?a=c:a.push(s);var u=[],p="<strong>Link</strong>: "+s,d=!1;a.forEach((function(e){f["a"].state.map.disruptions.forEach((function(e){if(e.affectedLinks.includes(s)&&(d=!0,f["a"].commit(m["q"],[s]),a=f["a"].state.map.selectedMATSimLink,n.disruptionSelected=!0,d)){var t=e.absoluteSpeed?" km/h":"% Slower";p+="<br><strong>Description</strong>: "+e.description+"<br><strong>Time</strong>: "+e.start+"-"+e.end+"<br><strong>Speed</strong>: "+e.speed+t+"<br><strong>Affected Links: </strong>:<br>",u=e.affectedLinks,e.affectedLinks.forEach((function(e){p+=e+"<br>"}))}})),n.disruptionSelected&&0==d&&(f["a"].commit(m["q"],[s]),a=f["a"].state.map.selectedMATSimLink,n.disruptionSelected=!1)})),t=i.reduce((function(e,t){return d?u.forEach((function(t){e.push(t)})):a.forEach((function(t){e.push(t)})),e}),["in","ID"]),(new l.a.Popup).setLngLat(r).setHTML(p).addTo(this.mapInstance),f["a"].commit(m["q"],a)}else t=["in","ID",""],f["a"].commit(m["o"],a);var h=["in","ID",""],y=["in","ID",""];d?h=t:y=t,this.mapInstance.setFilter(this.selectedDisruptionMATSimLayer,h),this.mapInstance.setFilter(this.highlightMATSimLayer,y)}}},v=y,b=(n("0a6f"),n("2877")),g=Object(b["a"])(v,a,o,!1,null,"05e0e45d",null);t["a"]=g.exports},a69a:function(e,t,n){"use strict";var a=n("98bd"),o=n.n(a);o.a},e332:function(e,t,n){},e996:function(e,t,n){}});
//# sourceMappingURL=app.fb85c9d6.js.map